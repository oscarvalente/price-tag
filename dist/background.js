!function(){"use strict";var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};function e(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}function r(t){return"function"==typeof t}var n=!1,o={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){t&&(new Error).stack;n=t},get useDeprecatedSynchronousErrorHandling(){return n}};function i(t){setTimeout(function(){throw t})}var c={closed:!0,next:function(t){},error:function(t){if(o.useDeprecatedSynchronousErrorHandling)throw t;i(t)},complete:function(){}},u=Array.isArray||function(t){return t&&"number"==typeof t.length};function a(t){return null!=t&&"object"==typeof t}var s,l={e:{}};function p(){try{return s.apply(this,arguments)}catch(t){return l.e=t,l}}function f(t){return s=t,p}function d(t){return Error.call(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map(function(t,e){return e+1+") "+t.toString()}).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t,this}d.prototype=Object.create(Error.prototype);var h=d,b=function(){function t(t){this.closed=!1,this._parent=null,this._parents=null,this._subscriptions=null,t&&(this._unsubscribe=t)}var e;return t.prototype.unsubscribe=function(){var t,e=!1;if(!this.closed){var n=this._parent,o=this._parents,i=this._unsubscribe,c=this._subscriptions;this.closed=!0,this._parent=null,this._parents=null,this._subscriptions=null;for(var s=-1,p=o?o.length:0;n;)n.remove(this),n=++s<p&&o[s]||null;if(r(i))f(i).call(this)===l&&(e=!0,t=t||(l.e instanceof h?v(l.e.errors):[l.e]));if(u(c))for(s=-1,p=c.length;++s<p;){var d=c[s];if(a(d))if(f(d.unsubscribe).call(d)===l){e=!0,t=t||[];var b=l.e;b instanceof h?t=t.concat(v(b.errors)):t.push(b)}}if(e)throw new h(t)}},t.prototype.add=function(e){if(!e||e===t.EMPTY)return t.EMPTY;if(e===this)return this;var r=e;switch(typeof e){case"function":r=new t(e);case"object":if(r.closed||"function"!=typeof r.unsubscribe)return r;if(this.closed)return r.unsubscribe(),r;if("function"!=typeof r._addParent){var n=r;(r=new t)._subscriptions=[n]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}return(this._subscriptions||(this._subscriptions=[])).push(r),r._addParent(this),r},t.prototype.remove=function(t){var e=this._subscriptions;if(e){var r=e.indexOf(t);-1!==r&&e.splice(r,1)}},t.prototype._addParent=function(t){var e=this._parent,r=this._parents;e&&e!==t?r?-1===r.indexOf(t)&&r.push(t):this._parents=[t]:this._parent=t},t.EMPTY=((e=new t).closed=!0,e),t}();function v(t){return t.reduce(function(t,e){return t.concat(e instanceof h?e.errors:e)},[])}var y="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random(),_=function(t){function r(e,n,o){var i=t.call(this)||this;switch(i.syncErrorValue=null,i.syncErrorThrown=!1,i.syncErrorThrowable=!1,i.isStopped=!1,i._parentSubscription=null,arguments.length){case 0:i.destination=c;break;case 1:if(!e){i.destination=c;break}if("object"==typeof e){e instanceof r?(i.syncErrorThrowable=e.syncErrorThrowable,i.destination=e,e.add(i)):(i.syncErrorThrowable=!0,i.destination=new m(i,e));break}default:i.syncErrorThrowable=!0,i.destination=new m(i,e,n,o)}return i}return e(r,t),r.prototype[y]=function(){return this},r.create=function(t,e,n){var o=new r(t,e,n);return o.syncErrorThrowable=!1,o},r.prototype.next=function(t){this.isStopped||this._next(t)},r.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},r.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},r.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this))},r.prototype._next=function(t){this.destination.next(t)},r.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},r.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},r.prototype._unsubscribeAndRecycle=function(){var t=this._parent,e=this._parents;return this._parent=null,this._parents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parent=t,this._parents=e,this._parentSubscription=null,this},r}(b),m=function(t){function n(e,n,o,i){var u,a=t.call(this)||this;a._parentSubscriber=e;var s=a;return r(n)?u=n:n&&(u=n.next,o=n.error,i=n.complete,n!==c&&(r((s=Object.create(n)).unsubscribe)&&a.add(s.unsubscribe.bind(s)),s.unsubscribe=a.unsubscribe.bind(a))),a._context=s,a._next=u,a._error=o,a._complete=i,a}return e(n,t),n.prototype.next=function(t){if(!this.isStopped&&this._next){var e=this._parentSubscriber;o.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}},n.prototype.error=function(t){if(!this.isStopped){var e=this._parentSubscriber,r=o.useDeprecatedSynchronousErrorHandling;if(this._error)r&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)r?(e.syncErrorValue=t,e.syncErrorThrown=!0):i(t),this.unsubscribe();else{if(this.unsubscribe(),r)throw t;i(t)}}},n.prototype.complete=function(){var t=this;if(!this.isStopped){var e=this._parentSubscriber;if(this._complete){var r=function(){return t._complete.call(t._context)};o.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,r),this.unsubscribe()):(this.__tryOrUnsub(r),this.unsubscribe())}else this.unsubscribe()}},n.prototype.__tryOrUnsub=function(t,e){try{t.call(this._context,e)}catch(t){if(this.unsubscribe(),o.useDeprecatedSynchronousErrorHandling)throw t;i(t)}},n.prototype.__tryOrSetError=function(t,e,r){if(!o.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,r)}catch(e){return o.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=e,t.syncErrorThrown=!0,!0):(i(e),!0)}return!1},n.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()},n}(_);var E="function"==typeof Symbol&&Symbol.observable||"@@observable";function S(){}var g=function(){function t(t){this._isScalar=!1,t&&(this._subscribe=t)}return t.prototype.lift=function(e){var r=new t;return r.source=this,r.operator=e,r},t.prototype.subscribe=function(t,e,r){var n=this.operator,i=function(t,e,r){if(t){if(t instanceof _)return t;if(t[y])return t[y]()}return t||e||r?new _(t,e,r):new _(c)}(t,e,r);if(n?n.call(i,this.source):i.add(this.source||o.useDeprecatedSynchronousErrorHandling&&!i.syncErrorThrowable?this._subscribe(i):this._trySubscribe(i)),o.useDeprecatedSynchronousErrorHandling&&i.syncErrorThrowable&&(i.syncErrorThrowable=!1,i.syncErrorThrown))throw i.syncErrorValue;return i},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){o.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),!function(t){for(;t;){var e=t,r=e.closed,n=e.destination,o=e.isStopped;if(r||o)return!1;t=n&&n instanceof _?n:null}return!0}(t)?console.warn(e):t.error(e)}},t.prototype.forEach=function(t,e){var r=this;return new(e=T(e))(function(e,n){var o;o=r.subscribe(function(e){try{t(e)}catch(t){n(t),o&&o.unsubscribe()}},n,e)})},t.prototype._subscribe=function(t){var e=this.source;return e&&e.subscribe(t)},t.prototype[E]=function(){return this},t.prototype.pipe=function(){for(var t,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return 0===e.length?this:((t=e)?1===t.length?t[0]:function(e){return t.reduce(function(t,e){return e(t)},e)}:S)(this)},t.prototype.toPromise=function(t){var e=this;return new(t=T(t))(function(t,r){var n;e.subscribe(function(t){return n=t},function(t){return r(t)},function(){return t(n)})})},t.create=function(e){return new t(e)},t}();function T(t){if(t||(t=o.Promise||Promise),!t)throw new Error("no Promise impl found");return t}function A(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}A.prototype=Object.create(Error.prototype);var R=function(t){function r(e){var r=t.call(this,e)||this;return r.destination=e,r}return e(r,t),r}(_);var I=function(){function t(t){this.connectable=t}return t.prototype.call=function(t,e){var r=this.connectable;r._refCount++;var n=new w(t,r),o=e.subscribe(n);return n.closed||(n.connection=r.connect()),o},t}(),w=function(t){function r(e,r){var n=t.call(this,e)||this;return n.connectable=r,n}return e(r,t),r.prototype._unsubscribe=function(){var t=this.connectable;if(t){this.connectable=null;var e=t._refCount;if(e<=0)this.connection=null;else if(t._refCount=e-1,e>1)this.connection=null;else{var r=this.connection,n=t._connection;this.connection=null,!n||r&&n!==r||n.unsubscribe()}}else this.connection=null},r}(_),O=function(t){function r(e,r){var n=t.call(this)||this;return n.source=e,n.subjectFactory=r,n._refCount=0,n._isComplete=!1,n}return e(r,t),r.prototype._subscribe=function(t){return this.getSubject().subscribe(t)},r.prototype.getSubject=function(){var t=this._subject;return t&&!t.isStopped||(this._subject=this.subjectFactory()),this._subject},r.prototype.connect=function(){var t=this._connection;return t||(this._isComplete=!1,(t=this._connection=new b).add(this.source.subscribe(new C(this.getSubject(),this))),t.closed?(this._connection=null,t=b.EMPTY):this._connection=t),t},r.prototype.refCount=function(){return(t=this).lift(new I(t));var t},r}(g).prototype,C=(O._subscribe,O._isComplete,O.getSubject,O.connect,O.refCount,function(t){function r(e,r){var n=t.call(this,e)||this;return n.connectable=r,n}return e(r,t),r.prototype._error=function(e){this._unsubscribe(),t.prototype._error.call(this,e)},r.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),t.prototype._complete.call(this)},r.prototype._unsubscribe=function(){var t=this.connectable;if(t){this.connectable=null;var e=t._connection;t._refCount=0,t._subject=null,t._connection=null,e&&e.unsubscribe()}},r}(R)),U=function(t){function r(e,r){var n=t.call(this,e,r)||this;return n.scheduler=e,n.work=r,n.pending=!1,n}return e(r,t),r.prototype.schedule=function(t,e){if(void 0===e&&(e=0),this.closed)return this;this.state=t;var r=this.id,n=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(n,r,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(n,this.id,e),this},r.prototype.requestAsyncId=function(t,e,r){return void 0===r&&(r=0),setInterval(t.flush.bind(t,this),r)},r.prototype.recycleAsyncId=function(t,e,r){if(void 0===r&&(r=0),null!==r&&this.delay===r&&!1===this.pending)return e;clearInterval(e)},r.prototype.execute=function(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var r=this._execute(t,e);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},r.prototype._execute=function(t,e){var r=!1,n=void 0;try{this.work(t)}catch(t){r=!0,n=!!t&&t||new Error(t)}if(r)return this.unsubscribe(),n},r.prototype._unsubscribe=function(){var t=this.id,e=this.scheduler,r=e.actions,n=r.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==n&&r.splice(n,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null},r}(function(t){function r(e,r){return t.call(this)||this}return e(r,t),r.prototype.schedule=function(t,e){return void 0===e&&(e=0),this},r}(b)),P=function(){function t(e,r){void 0===r&&(r=t.now),this.SchedulerAction=e,this.now=r}return t.prototype.schedule=function(t,e,r){return void 0===e&&(e=0),new this.SchedulerAction(this,t).schedule(r,e)},t.now=function(){return Date.now()},t}(),j=function(t){function r(e,n){void 0===n&&(n=P.now);var o=t.call(this,e,function(){return r.delegate&&r.delegate!==o?r.delegate.now():n()})||this;return o.actions=[],o.active=!1,o.scheduled=void 0,o}return e(r,t),r.prototype.schedule=function(e,n,o){return void 0===n&&(n=0),r.delegate&&r.delegate!==this?r.delegate.schedule(e,n,o):t.prototype.schedule.call(this,e,n,o)},r.prototype.flush=function(t){var e=this.actions;if(this.active)e.push(t);else{var r;this.active=!0;do{if(r=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,r){for(;t=e.shift();)t.unsubscribe();throw r}}},r}(P),D=new g(function(t){return t.complete()});function L(t){return t?function(t){return new g(function(e){return t.schedule(function(){return e.complete()})})}(t):D}function N(t){return t&&"function"==typeof t.schedule}var F=function(t){return function(e){for(var r=0,n=t.length;r<n&&!e.closed;r++)e.next(t[r]);e.closed||e.complete()}};function x(t,e){return new g(e?function(r){var n=new b,o=0;return n.add(e.schedule(function(){o!==t.length?(r.next(t[o++]),r.closed||n.add(this.schedule())):r.complete()})),n}:F(t))}function k(t){var e=new g(function(e){e.next(t),e.complete()});return e._isScalar=!0,e.value=t,e}function H(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=t[t.length-1];switch(N(r)?t.pop():r=void 0,t.length){case 0:return L(r);case 1:return r?x(t,r):k(t[0]);default:return x(t,r)}}var M=new j(U);function $(t){return t}function B(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}B.prototype=Object.create(Error.prototype);var G=B;function K(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}K.prototype=Object.create(Error.prototype);function V(t,e){return function(r){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return r.lift(new W(t,e))}}var W=function(){function t(t,e){this.project=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new z(t,this.project,this.thisArg))},t}(),z=function(t){function r(e,r,n){var o=t.call(this,e)||this;return o.project=r,o.count=0,o.thisArg=n||o,o}return e(r,t),r.prototype._next=function(t){var e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}this.destination.next(e)},r}(_),Y=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return e(r,t),r.prototype.notifyNext=function(t,e,r,n,o){this.destination.next(e)},r.prototype.notifyError=function(t,e){this.destination.error(t)},r.prototype.notifyComplete=function(t){this.destination.complete()},r}(_),q=function(t){function r(e,r,n){var o=t.call(this)||this;return o.parent=e,o.outerValue=r,o.outerIndex=n,o.index=0,o}return e(r,t),r.prototype._next=function(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)},r.prototype._error=function(t){this.parent.notifyError(t,this),this.unsubscribe()},r.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},r}(_),J=function(t){return function(e){return t.then(function(t){e.closed||(e.next(t),e.complete())},function(t){return e.error(t)}).then(null,i),e}};function X(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}var Q=X(),Z=function(t){return function(e){for(var r=t[Q]();;){var n=r.next();if(n.done){e.complete();break}if(e.next(n.value),e.closed)break}return"function"==typeof r.return&&e.add(function(){r.return&&r.return()}),e}},tt=function(t){return function(e){var r=t[E]();if("function"!=typeof r.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return r.subscribe(e)}},et=function(t){return t&&"number"==typeof t.length&&"function"!=typeof t};function rt(t){return t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}var nt=function(t){if(t instanceof g)return function(e){return t._isScalar?(e.next(t.value),void e.complete()):t.subscribe(e)};if(t&&"function"==typeof t[E])return tt(t);if(et(t))return F(t);if(rt(t))return J(t);if(t&&"function"==typeof t[Q])return Z(t);var e=a(t)?"an invalid object":"'"+t+"'";throw new TypeError("You provided "+e+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")};function ot(t,e,r,n,o){if(void 0===o&&(o=new q(t,r,n)),!o.closed)return nt(e)(o)}function it(t,e){if(!e)return t instanceof g?t:new g(nt(t));if(null!=t){if(function(t){return t&&"function"==typeof t[E]}(t))return function(t,e){return new g(e?function(r){var n=new b;return n.add(e.schedule(function(){var o=t[E]();n.add(o.subscribe({next:function(t){n.add(e.schedule(function(){return r.next(t)}))},error:function(t){n.add(e.schedule(function(){return r.error(t)}))},complete:function(){n.add(e.schedule(function(){return r.complete()}))}}))})),n}:tt(t))}(t,e);if(rt(t))return function(t,e){return new g(e?function(r){var n=new b;return n.add(e.schedule(function(){return t.then(function(t){n.add(e.schedule(function(){r.next(t),n.add(e.schedule(function(){return r.complete()}))}))},function(t){n.add(e.schedule(function(){return r.error(t)}))})})),n}:J(t))}(t,e);if(et(t))return x(t,e);if(function(t){return t&&"function"==typeof t[Q]}(t)||"string"==typeof t)return function(t,e){if(!t)throw new Error("Iterable cannot be null");return new g(e?function(r){var n,o=new b;return o.add(function(){n&&"function"==typeof n.return&&n.return()}),o.add(e.schedule(function(){n=t[Q](),o.add(e.schedule(function(){if(!r.closed){var t,e;try{var o=n.next();t=o.value,e=o.done}catch(t){return void r.error(t)}e?r.complete():(r.next(t),this.schedule())}}))})),o}:Z(t))}(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}function ct(t,e,r){return void 0===r&&(r=Number.POSITIVE_INFINITY),"function"==typeof e?function(n){return n.pipe(ct(function(r,n){return it(t(r,n)).pipe(V(function(t,o){return e(r,t,n,o)}))},r))}:("number"==typeof e&&(r=e),function(e){return e.lift(new ut(t,r))})}var ut=function(){function t(t,e){void 0===e&&(e=Number.POSITIVE_INFINITY),this.project=t,this.concurrent=e}return t.prototype.call=function(t,e){return e.subscribe(new at(t,this.project,this.concurrent))},t}(),at=function(t){function r(e,r,n){void 0===n&&(n=Number.POSITIVE_INFINITY);var o=t.call(this,e)||this;return o.project=r,o.concurrent=n,o.hasCompleted=!1,o.buffer=[],o.active=0,o.index=0,o}return e(r,t),r.prototype._next=function(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)},r.prototype._tryNext=function(t){var e,r=this.index++;try{e=this.project(t,r)}catch(t){return void this.destination.error(t)}this.active++,this._innerSub(e,t,r)},r.prototype._innerSub=function(t,e,r){var n=new q(this,void 0,void 0);this.destination.add(n),ot(this,t,e,r,n)},r.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()},r.prototype.notifyNext=function(t,e,r,n,o){this.destination.next(e)},r.prototype.notifyComplete=function(t){var e=this.buffer;this.remove(t),this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},r}(Y);function st(t){return void 0===t&&(t=Number.POSITIVE_INFINITY),ct($,t)}function lt(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 1===t.length||2===t.length&&N(t[1])?it(t[0]):st(1)(H.apply(void 0,t))}function pt(){for(var t,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return"function"==typeof e[e.length-1]&&(t=e.pop()),1===e.length&&u(e[0])&&(e=e[0]),0===e.length?D:t?pt(e).pipe(V(function(e){return t.apply(void 0,e)})):new g(function(t){return new ft(t,e)})}var ft=function(t){function r(e,r){var n=t.call(this,e)||this;n.sources=r,n.completed=0,n.haveValues=0;var o=r.length;n.values=new Array(o);for(var i=0;i<o;i++){var c=ot(n,r[i],null,i);c&&n.add(c)}return n}return e(r,t),r.prototype.notifyNext=function(t,e,r,n,o){this.values[r]=e,o._hasValue||(o._hasValue=!0,this.haveValues++)},r.prototype.notifyComplete=function(t){var e=this.destination,r=this.haveValues,n=this.values,o=n.length;t._hasValue?(this.completed++,this.completed===o&&(r===o&&e.next(n),e.complete())):e.complete()},r}(Y);function dt(t,e,n){return n?dt(t,e).pipe(V(function(t){return u(t)?n.apply(void 0,t):n(t)})):new g(function(n){var o,i=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return n.next(1===t.length?t[0]:t)};try{o=t(i)}catch(t){return void n.error(t)}if(r(e))return function(){return e(i,o)}})}function ht(t){return!u(t)&&t-parseFloat(t)+1>=0}function bt(t,e){return void 0===t&&(t=0),void 0===e&&(e=M),(!ht(t)||t<0)&&(t=0),e&&"function"==typeof e.schedule||(e=M),new g(function(r){return r.add(e.schedule(vt,t,{subscriber:r,counter:0,period:t})),r})}function vt(t){var e=t.subscriber,r=t.counter,n=t.period;e.next(r),this.schedule({subscriber:e,counter:r+1,period:n},n)}function yt(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=Number.POSITIVE_INFINITY,n=null,o=t[t.length-1];return N(o)?(n=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(r=t.pop())):"number"==typeof o&&(r=t.pop()),null===n&&1===t.length&&t[0]instanceof g?t[0]:st(r)(x(t,n))}function _t(t,e,r){return void 0===t&&(t=0),void 0===e&&(e=0),new g(function(n){var o=0,i=t;if(r)return r.schedule(mt,0,{index:o,count:e,start:t,subscriber:n});for(;;){if(o++>=e){n.complete();break}if(n.next(i++),n.closed)break}})}function mt(t){var e=t.start,r=t.index,n=t.count,o=t.subscriber;r>=n?o.complete():(o.next(e),o.closed||(t.index=r+1,t.start=e+1,this.schedule(t)))}var Et=function(){function t(t){this.selector=t}return t.prototype.call=function(t,e){return e.subscribe(new St(t,this.selector,this.caught))},t}(),St=function(t){function r(e,r,n){var o=t.call(this,e)||this;return o.selector=r,o.caught=n,o}return e(r,t),r.prototype.error=function(e){if(!this.isStopped){var r=void 0;try{r=this.selector(e,this.caught)}catch(e){return void t.prototype.error.call(this,e)}this._unsubscribeAndRecycle();var n=new q(this,void 0,void 0);this.add(n),ot(this,r,void 0,void 0,n)}},r}(Y);function gt(t,e){return function(r){return r.lift(new Tt(t,e))}}var Tt=function(){function t(t,e){this.predicate=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new At(t,this.predicate,this.thisArg))},t}(),At=function(t){function r(e,r,n){var o=t.call(this,e)||this;return o.predicate=r,o.thisArg=n,o.count=0,o}return e(r,t),r.prototype._next=function(t){var e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}e&&this.destination.next(t)},r}(_);function Rt(t,e,r){return function(n){return n.lift(new It(t,e,r))}}var It=function(){function t(t,e,r){this.nextOrObserver=t,this.error=e,this.complete=r}return t.prototype.call=function(t,e){return e.subscribe(new wt(t,this.nextOrObserver,this.error,this.complete))},t}(),wt=function(t){function n(e,n,o,i){var c=t.call(this,e)||this;return c._tapNext=S,c._tapError=S,c._tapComplete=S,c._tapError=o||S,c._tapComplete=i||S,r(n)?(c._context=c,c._tapNext=n):n&&(c._context=n,c._tapNext=n.next||S,c._tapError=n.error||S,c._tapComplete=n.complete||S),c}return e(n,t),n.prototype._next=function(t){try{this._tapNext.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.next(t)},n.prototype._error=function(t){try{this._tapError.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.error(t)},n.prototype._complete=function(){try{this._tapComplete.call(this._context)}catch(t){return void this.destination.error(t)}return this.destination.complete()},n}(_);function Ot(t){return function(e){return 0===t?L():e.lift(new Ct(t))}}var Ct=function(){function t(t){if(this.total=t,this.total<0)throw new G}return t.prototype.call=function(t,e){return e.subscribe(new Ut(t,this.total))},t}(),Ut=function(t){function r(e,r){var n=t.call(this,e)||this;return n.total=r,n.count=0,n}return e(r,t),r.prototype._next=function(t){var e=this.total,r=++this.count;r<=e&&(this.destination.next(t),r===e&&(this.destination.complete(),this.unsubscribe()))},r}(_);function Pt(t){return function(e){return e.lift(new jt(t))}}var jt=function(){function t(t){this.value=t}return t.prototype.call=function(t,e){return e.subscribe(new Dt(t,this.value))},t}(),Dt=function(t){function r(e,r){var n=t.call(this,e)||this;return n.value=r,n}return e(r,t),r.prototype._next=function(t){this.destination.next(this.value)},r}(_);function Lt(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){var r=t[t.length-1];N(r)?t.pop():r=null;var n=t.length;return lt(1!==n||r?n>0?x(t,r):L(r):k(t[0]),e)}}function Nt(t,e){return"function"==typeof e?function(r){return r.pipe(Nt(function(r,n){return it(t(r,n)).pipe(V(function(t,o){return e(r,t,n,o)}))}))}:function(e){return e.lift(new Ft(t))}}var Ft=function(){function t(t){this.project=t}return t.prototype.call=function(t,e){return e.subscribe(new xt(t,this.project))},t}(),xt=function(t){function r(e,r){var n=t.call(this,e)||this;return n.project=r,n.index=0,n}return e(r,t),r.prototype._next=function(t){var e,r=this.index++;try{e=this.project(t,r)}catch(t){return void this.destination.error(t)}this._innerSub(e,t,r)},r.prototype._innerSub=function(t,e,r){var n=this.innerSubscription;n&&n.unsubscribe();var o=new q(this,void 0,void 0);this.destination.add(o),this.innerSubscription=ot(this,t,e,r,o)},r.prototype._complete=function(){var e=this.innerSubscription;e&&!e.closed||t.prototype._complete.call(this),this.unsubscribe()},r.prototype._unsubscribe=function(){this.innerSubscription=null},r.prototype.notifyComplete=function(e){this.destination.remove(e),this.innerSubscription=null,this.isStopped&&t.prototype._complete.call(this)},r.prototype.notifyNext=function(t,e,r,n,o){this.destination.next(e)},r}(Y);const kt="TIME";var Ht=Object.freeze({TIME:kt,CURRENT_PRICE:"CURRENT_PRICE"});const Mt=18e4,$t=12e4,Bt=10,Gt=12e4,Kt="Price Tag",Vt="Price Tag - This item is being tracked",Wt={POPUP_STATUS:"POPUP.STATUS",RECORD_ATTEMPT:"RECORD.ATTEMPT",RECORD_START:"RECORD.START",RECORD_CANCEL:"RECORD.CANCEL",AUTO_SAVE_STATUS:"AUTO_SAVE.STATUS",AUTO_SAVE_CHECK_STATUS:"AUTO_SAVE.CHECK_STATUS",AUTO_SAVE_ATTEMPT:"AUTO_SAVE.ATTEMPT",AUTO_SAVE_HIGHLIGHT_PRE_START:"AUTO_SAVE.HIGHLIGHT.PRE_START",AUTO_SAVE_HIGHLIGHT_PRE_STOP:"AUTO_SAVE.HIGHLIGHT.PRE_STOP",PRICE_TAG_HIGHLIGHT_START:"PRICE_TAG.HIGHLIGHT.START",PRICE_TAG_HIGHLIGHT_STOP:"PRICE_TAG.HIGHLIGHT.STOP",PRICE_UPDATE_STATUS:"PRICE_UPDATE.STATUS",PRICE_UPDATE_CHECK_STATUS:"PRICE_UPDATE.CHECK_STATUS",PRICE_UPDATE_ATTEMPT:"PRICE_UPDATE.ATTEMPT",PRICE_UPDATE_HIGHLIGHT_PRE_START:"PRICE_UPDATE.HIGHLIGHT.PRE_START",PRICE_UPDATE_HIGHLIGHT_PRE_STOP:"PRICE_UPDATE.HIGHLIGHT.PRE_STOP",STOP_FOLLOW_STATUS:"STOP_FOLLOW.STATUS",STOP_FOLLOW_ATTEMPT:"STOP_FOLLOW.ATTEMPT",TRACKED_ITEMS_OPEN:"TRACKED_ITEMS.OPEN",TRACKED_ITEMS_GET:"TRACKED_ITEMS.GET",TRACKED_ITEMS_UNFOLLOW:"TRACKED_ITEMS.UNFOLLOW",TRACKED_ITEMS_SET_UNDO_STATUS:"TRACKED_ITEMS.SET_UNDO_STATUS",TRACKED_ITEMS_CHANGE_SORT:"TRACKED_ITEMS.CHANGE_SORT",TRACKED_ITEMS_UNDO_ATTEMPT:"TRACKED_ITEMS.UNDO_ATTEMPT",CONFIRMATION_DISPLAY_CREATE:"CONFIRMATION_DISPLAY.CREATE",CONFIRMATION_DISPLAY_LOAD:"CONFIRMATION_DISPLAY.LOAD",CONFIRMATION_DISPLAY_REMOVE:"CONFIRMATION_DISPLAY.REMOVE"},zt="assets/icon_48.png",Yt="assets/icon_active_48.png",qt="./assets/time-is-money.svg",Jt="./assets/time.svg",Xt="./assets/coin.svg";function Qt(){chrome.browserAction.setTitle({title:Kt}),chrome.browserAction.setIcon({path:zt})}function Zt(){chrome.browserAction.setTitle({title:Vt}),chrome.browserAction.setIcon({path:Yt})}function te(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ee(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),n.forEach(function(e){te(t,e,r[e])})}return t}var re=function(){this.__data__=[],this.size=0};var ne=function(t,e){return t===e||t!=t&&e!=e};var oe=function(t,e){for(var r=t.length;r--;)if(ne(t[r][0],e))return r;return-1},ie=Array.prototype.splice;var ce=function(t){var e=this.__data__,r=oe(e,t);return!(r<0||(r==e.length-1?e.pop():ie.call(e,r,1),--this.size,0))};var ue=function(t){var e=this.__data__,r=oe(e,t);return r<0?void 0:e[r][1]};var ae=function(t){return oe(this.__data__,t)>-1};var se=function(t,e){var r=this.__data__,n=oe(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this};function le(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}le.prototype.clear=re,le.prototype.delete=ce,le.prototype.get=ue,le.prototype.has=ae,le.prototype.set=se;var pe=le;var fe=function(){this.__data__=new pe,this.size=0};var de=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r};var he=function(t){return this.__data__.get(t)};var be=function(t){return this.__data__.has(t)},ve="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function ye(t,e){return t(e={exports:{}},e.exports),e.exports}var _e="object"==typeof ve&&ve&&ve.Object===Object&&ve,me="object"==typeof self&&self&&self.Object===Object&&self,Ee=_e||me||Function("return this")(),Se=Ee.Symbol,ge=Object.prototype,Te=ge.hasOwnProperty,Ae=ge.toString,Re=Se?Se.toStringTag:void 0;var Ie=function(t){var e=Te.call(t,Re),r=t[Re];try{t[Re]=void 0}catch(t){}var n=Ae.call(t);return e?t[Re]=r:delete t[Re],n},we=Object.prototype.toString;var Oe=function(t){return we.call(t)},Ce="[object Null]",Ue="[object Undefined]",Pe=Se?Se.toStringTag:void 0;var je=function(t){return null==t?void 0===t?Ue:Ce:Pe&&Pe in Object(t)?Ie(t):Oe(t)};var De=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)},Le="[object AsyncFunction]",Ne="[object Function]",Fe="[object GeneratorFunction]",xe="[object Proxy]";var ke,He=function(t){if(!De(t))return!1;var e=je(t);return e==Ne||e==Fe||e==Le||e==xe},Me=Ee["__core-js_shared__"],$e=(ke=/[^.]+$/.exec(Me&&Me.keys&&Me.keys.IE_PROTO||""))?"Symbol(src)_1."+ke:"";var Be=function(t){return!!$e&&$e in t},Ge=Function.prototype.toString;var Ke=function(t){if(null!=t){try{return Ge.call(t)}catch(t){}try{return t+""}catch(t){}}return""},Ve=/^\[object .+?Constructor\]$/,We=Function.prototype,ze=Object.prototype,Ye=We.toString,qe=ze.hasOwnProperty,Je=RegExp("^"+Ye.call(qe).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var Xe=function(t){return!(!De(t)||Be(t))&&(He(t)?Je:Ve).test(Ke(t))};var Qe=function(t,e){return null==t?void 0:t[e]};var Ze=function(t,e){var r=Qe(t,e);return Xe(r)?r:void 0},tr=Ze(Ee,"Map"),er=Ze(Object,"create");var rr=function(){this.__data__=er?er(null):{},this.size=0};var nr=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},or="__lodash_hash_undefined__",ir=Object.prototype.hasOwnProperty;var cr=function(t){var e=this.__data__;if(er){var r=e[t];return r===or?void 0:r}return ir.call(e,t)?e[t]:void 0},ur=Object.prototype.hasOwnProperty;var ar=function(t){var e=this.__data__;return er?void 0!==e[t]:ur.call(e,t)},sr="__lodash_hash_undefined__";var lr=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=er&&void 0===e?sr:e,this};function pr(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}pr.prototype.clear=rr,pr.prototype.delete=nr,pr.prototype.get=cr,pr.prototype.has=ar,pr.prototype.set=lr;var fr=pr;var dr=function(){this.size=0,this.__data__={hash:new fr,map:new(tr||pe),string:new fr}};var hr=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t};var br=function(t,e){var r=t.__data__;return hr(e)?r["string"==typeof e?"string":"hash"]:r.map};var vr=function(t){var e=br(this,t).delete(t);return this.size-=e?1:0,e};var yr=function(t){return br(this,t).get(t)};var _r=function(t){return br(this,t).has(t)};var mr=function(t,e){var r=br(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this};function Er(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Er.prototype.clear=dr,Er.prototype.delete=vr,Er.prototype.get=yr,Er.prototype.has=_r,Er.prototype.set=mr;var Sr=Er,gr=200;var Tr=function(t,e){var r=this.__data__;if(r instanceof pe){var n=r.__data__;if(!tr||n.length<gr-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new Sr(n)}return r.set(t,e),this.size=r.size,this};function Ar(t){var e=this.__data__=new pe(t);this.size=e.size}Ar.prototype.clear=fe,Ar.prototype.delete=de,Ar.prototype.get=he,Ar.prototype.has=be,Ar.prototype.set=Tr;var Rr=Ar;var Ir=function(t,e){for(var r=-1,n=null==t?0:t.length;++r<n&&!1!==e(t[r],r,t););return t},wr=function(){try{var t=Ze(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();var Or=function(t,e,r){"__proto__"==e&&wr?wr(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r},Cr=Object.prototype.hasOwnProperty;var Ur=function(t,e,r){var n=t[e];Cr.call(t,e)&&ne(n,r)&&(void 0!==r||e in t)||Or(t,e,r)};var Pr=function(t,e,r,n){var o=!r;r||(r={});for(var i=-1,c=e.length;++i<c;){var u=e[i],a=n?n(r[u],t[u],u,r,t):void 0;void 0===a&&(a=t[u]),o?Or(r,u,a):Ur(r,u,a)}return r};var jr=function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n};var Dr=function(t){return null!=t&&"object"==typeof t},Lr="[object Arguments]";var Nr=function(t){return Dr(t)&&je(t)==Lr},Fr=Object.prototype,xr=Fr.hasOwnProperty,kr=Fr.propertyIsEnumerable,Hr=Nr(function(){return arguments}())?Nr:function(t){return Dr(t)&&xr.call(t,"callee")&&!kr.call(t,"callee")},Mr=Array.isArray;var $r=function(){return!1},Br=ye(function(t,e){var r=e&&!e.nodeType&&e,n=r&&t&&!t.nodeType&&t,o=n&&n.exports===r?Ee.Buffer:void 0,i=(o?o.isBuffer:void 0)||$r;t.exports=i}),Gr=9007199254740991,Kr=/^(?:0|[1-9]\d*)$/;var Vr=function(t,e){var r=typeof t;return!!(e=null==e?Gr:e)&&("number"==r||"symbol"!=r&&Kr.test(t))&&t>-1&&t%1==0&&t<e},Wr=9007199254740991;var zr=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=Wr},Yr={};Yr["[object Float32Array]"]=Yr["[object Float64Array]"]=Yr["[object Int8Array]"]=Yr["[object Int16Array]"]=Yr["[object Int32Array]"]=Yr["[object Uint8Array]"]=Yr["[object Uint8ClampedArray]"]=Yr["[object Uint16Array]"]=Yr["[object Uint32Array]"]=!0,Yr["[object Arguments]"]=Yr["[object Array]"]=Yr["[object ArrayBuffer]"]=Yr["[object Boolean]"]=Yr["[object DataView]"]=Yr["[object Date]"]=Yr["[object Error]"]=Yr["[object Function]"]=Yr["[object Map]"]=Yr["[object Number]"]=Yr["[object Object]"]=Yr["[object RegExp]"]=Yr["[object Set]"]=Yr["[object String]"]=Yr["[object WeakMap]"]=!1;var qr=function(t){return Dr(t)&&zr(t.length)&&!!Yr[je(t)]};var Jr=function(t){return function(e){return t(e)}},Xr=ye(function(t,e){var r=e&&!e.nodeType&&e,n=r&&t&&!t.nodeType&&t,o=n&&n.exports===r&&_e.process,i=function(){try{var t=n&&n.require&&n.require("util").types;return t||o&&o.binding&&o.binding("util")}catch(t){}}();t.exports=i}),Qr=Xr&&Xr.isTypedArray,Zr=Qr?Jr(Qr):qr,tn=Object.prototype.hasOwnProperty;var en=function(t,e){var r=Mr(t),n=!r&&Hr(t),o=!r&&!n&&Br(t),i=!r&&!n&&!o&&Zr(t),c=r||n||o||i,u=c?jr(t.length,String):[],a=u.length;for(var s in t)!e&&!tn.call(t,s)||c&&("length"==s||o&&("offset"==s||"parent"==s)||i&&("buffer"==s||"byteLength"==s||"byteOffset"==s)||Vr(s,a))||u.push(s);return u},rn=Object.prototype;var nn=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||rn)};var on=function(t,e){return function(r){return t(e(r))}},cn=on(Object.keys,Object),un=Object.prototype.hasOwnProperty;var an=function(t){if(!nn(t))return cn(t);var e=[];for(var r in Object(t))un.call(t,r)&&"constructor"!=r&&e.push(r);return e};var sn=function(t){return null!=t&&zr(t.length)&&!He(t)};var ln=function(t){return sn(t)?en(t):an(t)};var pn=function(t,e){return t&&Pr(e,ln(e),t)};var fn=function(t){var e=[];if(null!=t)for(var r in Object(t))e.push(r);return e},dn=Object.prototype.hasOwnProperty;var hn=function(t){if(!De(t))return fn(t);var e=nn(t),r=[];for(var n in t)("constructor"!=n||!e&&dn.call(t,n))&&r.push(n);return r};var bn=function(t){return sn(t)?en(t,!0):hn(t)};var vn=function(t,e){return t&&Pr(e,bn(e),t)},yn=ye(function(t,e){var r=e&&!e.nodeType&&e,n=r&&t&&!t.nodeType&&t,o=n&&n.exports===r?Ee.Buffer:void 0,i=o?o.allocUnsafe:void 0;t.exports=function(t,e){if(e)return t.slice();var r=t.length,n=i?i(r):new t.constructor(r);return t.copy(n),n}});var _n=function(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e};var mn=function(t,e){for(var r=-1,n=null==t?0:t.length,o=0,i=[];++r<n;){var c=t[r];e(c,r,t)&&(i[o++]=c)}return i};var En=function(){return[]},Sn=Object.prototype.propertyIsEnumerable,gn=Object.getOwnPropertySymbols,Tn=gn?function(t){return null==t?[]:(t=Object(t),mn(gn(t),function(e){return Sn.call(t,e)}))}:En;var An=function(t,e){return Pr(t,Tn(t),e)};var Rn=function(t,e){for(var r=-1,n=e.length,o=t.length;++r<n;)t[o+r]=e[r];return t},In=on(Object.getPrototypeOf,Object),wn=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)Rn(e,Tn(t)),t=In(t);return e}:En;var On=function(t,e){return Pr(t,wn(t),e)};var Cn=function(t,e,r){var n=e(t);return Mr(t)?n:Rn(n,r(t))};var Un=function(t){return Cn(t,ln,Tn)};var Pn=function(t){return Cn(t,bn,wn)},jn=Ze(Ee,"DataView"),Dn=Ze(Ee,"Promise"),Ln=Ze(Ee,"Set"),Nn=Ze(Ee,"WeakMap"),Fn=Ke(jn),xn=Ke(tr),kn=Ke(Dn),Hn=Ke(Ln),Mn=Ke(Nn),$n=je;(jn&&"[object DataView]"!=$n(new jn(new ArrayBuffer(1)))||tr&&"[object Map]"!=$n(new tr)||Dn&&"[object Promise]"!=$n(Dn.resolve())||Ln&&"[object Set]"!=$n(new Ln)||Nn&&"[object WeakMap]"!=$n(new Nn))&&($n=function(t){var e=je(t),r="[object Object]"==e?t.constructor:void 0,n=r?Ke(r):"";if(n)switch(n){case Fn:return"[object DataView]";case xn:return"[object Map]";case kn:return"[object Promise]";case Hn:return"[object Set]";case Mn:return"[object WeakMap]"}return e});var Bn=$n,Gn=Object.prototype.hasOwnProperty;var Kn=function(t){var e=t.length,r=new t.constructor(e);return e&&"string"==typeof t[0]&&Gn.call(t,"index")&&(r.index=t.index,r.input=t.input),r},Vn=Ee.Uint8Array;var Wn=function(t){var e=new t.constructor(t.byteLength);return new Vn(e).set(new Vn(t)),e};var zn=function(t,e){var r=e?Wn(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)},Yn=/\w*$/;var qn=function(t){var e=new t.constructor(t.source,Yn.exec(t));return e.lastIndex=t.lastIndex,e},Jn=Se?Se.prototype:void 0,Xn=Jn?Jn.valueOf:void 0;var Qn=function(t){return Xn?Object(Xn.call(t)):{}};var Zn=function(t,e){var r=e?Wn(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)},to="[object Boolean]",eo="[object Date]",ro="[object Map]",no="[object Number]",oo="[object RegExp]",io="[object Set]",co="[object String]",uo="[object Symbol]",ao="[object ArrayBuffer]",so="[object DataView]",lo="[object Float32Array]",po="[object Float64Array]",fo="[object Int8Array]",ho="[object Int16Array]",bo="[object Int32Array]",vo="[object Uint8Array]",yo="[object Uint8ClampedArray]",_o="[object Uint16Array]",mo="[object Uint32Array]";var Eo=function(t,e,r){var n=t.constructor;switch(e){case ao:return Wn(t);case to:case eo:return new n(+t);case so:return zn(t,r);case lo:case po:case fo:case ho:case bo:case vo:case yo:case _o:case mo:return Zn(t,r);case ro:return new n;case no:case co:return new n(t);case oo:return qn(t);case io:return new n;case uo:return Qn(t)}},So=Object.create,go=function(){function t(){}return function(e){if(!De(e))return{};if(So)return So(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}();var To=function(t){return"function"!=typeof t.constructor||nn(t)?{}:go(In(t))},Ao="[object Map]";var Ro=function(t){return Dr(t)&&Bn(t)==Ao},Io=Xr&&Xr.isMap,wo=Io?Jr(Io):Ro,Oo="[object Set]";var Co=function(t){return Dr(t)&&Bn(t)==Oo},Uo=Xr&&Xr.isSet,Po=Uo?Jr(Uo):Co,jo=1,Do=2,Lo=4,No="[object Arguments]",Fo="[object Function]",xo="[object GeneratorFunction]",ko="[object Object]",Ho={};Ho[No]=Ho["[object Array]"]=Ho["[object ArrayBuffer]"]=Ho["[object DataView]"]=Ho["[object Boolean]"]=Ho["[object Date]"]=Ho["[object Float32Array]"]=Ho["[object Float64Array]"]=Ho["[object Int8Array]"]=Ho["[object Int16Array]"]=Ho["[object Int32Array]"]=Ho["[object Map]"]=Ho["[object Number]"]=Ho[ko]=Ho["[object RegExp]"]=Ho["[object Set]"]=Ho["[object String]"]=Ho["[object Symbol]"]=Ho["[object Uint8Array]"]=Ho["[object Uint8ClampedArray]"]=Ho["[object Uint16Array]"]=Ho["[object Uint32Array]"]=!0,Ho["[object Error]"]=Ho[Fo]=Ho["[object WeakMap]"]=!1;var Mo=function t(e,r,n,o,i,c){var u,a=r&jo,s=r&Do,l=r&Lo;if(n&&(u=i?n(e,o,i,c):n(e)),void 0!==u)return u;if(!De(e))return e;var p=Mr(e);if(p){if(u=Kn(e),!a)return _n(e,u)}else{var f=Bn(e),d=f==Fo||f==xo;if(Br(e))return yn(e,a);if(f==ko||f==No||d&&!i){if(u=s||d?{}:To(e),!a)return s?On(e,vn(u,e)):An(e,pn(u,e))}else{if(!Ho[f])return i?e:{};u=Eo(e,f,a)}}c||(c=new Rr);var h=c.get(e);if(h)return h;if(c.set(e,u),Po(e))return e.forEach(function(o){u.add(t(o,r,n,o,e,c))}),u;if(wo(e))return e.forEach(function(o,i){u.set(i,t(o,r,n,i,e,c))}),u;var b=l?s?Pn:Un:s?keysIn:ln,v=p?void 0:b(e);return Ir(v||e,function(o,i){v&&(o=e[i=o]),Ur(u,i,t(o,r,n,i,e,c))}),u},$o=1,Bo=4;var Go=function(t){return Mo(t,$o|Bo)},Ko=4;var Vo=function(t){return Mo(t,Ko)},Wo="[object Symbol]";var zo=function(t){return"symbol"==typeof t||Dr(t)&&je(t)==Wo},Yo=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,qo=/^\w*$/;var Jo=function(t,e){if(Mr(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!zo(t))||qo.test(t)||!Yo.test(t)||null!=e&&t in Object(e)},Xo="Expected a function";function Qo(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError(Xo);var r=function(){var n=arguments,o=e?e.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var c=t.apply(this,n);return r.cache=i.set(o,c)||i,c};return r.cache=new(Qo.Cache||Sr),r}Qo.Cache=Sr;var Zo=Qo,ti=500;var ei=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ri=/\\(\\)?/g,ni=function(t){var e=Zo(t,function(t){return r.size===ti&&r.clear(),t}),r=e.cache;return e}(function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(ei,function(t,r,n,o){e.push(n?o.replace(ri,"$1"):r||t)}),e});var oi=function(t,e){for(var r=-1,n=null==t?0:t.length,o=Array(n);++r<n;)o[r]=e(t[r],r,t);return o},ii=1/0,ci=Se?Se.prototype:void 0,ui=ci?ci.toString:void 0;var ai=function t(e){if("string"==typeof e)return e;if(Mr(e))return oi(e,t)+"";if(zo(e))return ui?ui.call(e):"";var r=e+"";return"0"==r&&1/e==-ii?"-0":r};var si=function(t){return null==t?"":ai(t)};var li=function(t,e){return Mr(t)?t:Jo(t,e)?[t]:ni(si(t))},pi=1/0;var fi=function(t){if("string"==typeof t||zo(t))return t;var e=t+"";return"0"==e&&1/t==-pi?"-0":e};var di=function(t,e){for(var r=0,n=(e=li(e,t)).length;null!=t&&r<n;)t=t[fi(e[r++])];return r&&r==n?t:void 0};var hi=function(t,e,r){var n=null==t?void 0:di(t,e);return void 0===n?r:n},bi={PRICE:/((?:\d+[.,])?\d+(?:[.,]\d+)?)/,HOSTNAME:/https?:\/\/([\w.]+)\/*/,DOMAIN:/^([\w-]+\.)+[\w-]+\w$/,URL:/^https?:\/\/([\w-]+\.)+[\w-]+\w(\/[\w-=.]+)+\/?(\?([\w]+=?[\w-%!@()\\["#\]]+&?)*)?/,CAPTURE:{DOMAIN_IN_URL:/https?:\/\/([\w.]+)\/*/,HOSTNAME_AND_PATH:/^https?:\/\/((?:[\w-]+\.)+[\w-]+\w(?:\/[\w-=.]+)+\/?)/,PROTOCOL_HOSTNAME_AND_PATH:/^(https?:\/\/(?:[\w-]+\.)+[\w-]+\w(?:\/[\w-=.]+)+\/?)/}};function vi(t){const e=parseFloat(t.replace(",",".")).toFixed(2);return parseFloat(e)}function yi(t){return t&&(e=t,bi.CAPTURE.HOSTNAME_AND_PATH.test(e));var e}function _i(t){return bi.DOMAIN.test(t)}function mi(t){return bi.URL.test(t)}function Ei(t){const e=t.match(bi.CAPTURE.HOSTNAME_AND_PATH);let r=null;return e&&([,r]=e),r}function Si(t){const e=t.match(bi.CAPTURE.PROTOCOL_HOSTNAME_AND_PATH);let r=null;return e&&([,r]=e),r}var gi=function(t,e,r){var n;return r(t,function(t,r,o){if(e(t,r,o))return n=r,!1}),n};var Ti=function(t){return function(e,r,n){for(var o=-1,i=Object(e),c=n(e),u=c.length;u--;){var a=c[t?u:++o];if(!1===r(i[a],a,i))break}return e}}();var Ai=function(t,e){return t&&Ti(t,e,ln)},Ri="__lodash_hash_undefined__";var Ii=function(t){return this.__data__.set(t,Ri),this};var wi=function(t){return this.__data__.has(t)};function Oi(t){var e=-1,r=null==t?0:t.length;for(this.__data__=new Sr;++e<r;)this.add(t[e])}Oi.prototype.add=Oi.prototype.push=Ii,Oi.prototype.has=wi;var Ci=Oi;var Ui=function(t,e){for(var r=-1,n=null==t?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1};var Pi=function(t,e){return t.has(e)},ji=1,Di=2;var Li=function(t,e,r,n,o,i){var c=r&ji,u=t.length,a=e.length;if(u!=a&&!(c&&a>u))return!1;var s=i.get(t);if(s&&i.get(e))return s==e;var l=-1,p=!0,f=r&Di?new Ci:void 0;for(i.set(t,e),i.set(e,t);++l<u;){var d=t[l],h=e[l];if(n)var b=c?n(h,d,l,e,t,i):n(d,h,l,t,e,i);if(void 0!==b){if(b)continue;p=!1;break}if(f){if(!Ui(e,function(t,e){if(!Pi(f,e)&&(d===t||o(d,t,r,n,i)))return f.push(e)})){p=!1;break}}else if(d!==h&&!o(d,h,r,n,i)){p=!1;break}}return i.delete(t),i.delete(e),p};var Ni=function(t){var e=-1,r=Array(t.size);return t.forEach(function(t,n){r[++e]=[n,t]}),r};var Fi=function(t){var e=-1,r=Array(t.size);return t.forEach(function(t){r[++e]=t}),r},xi=1,ki=2,Hi="[object Boolean]",Mi="[object Date]",$i="[object Error]",Bi="[object Map]",Gi="[object Number]",Ki="[object RegExp]",Vi="[object Set]",Wi="[object String]",zi="[object Symbol]",Yi="[object ArrayBuffer]",qi="[object DataView]",Ji=Se?Se.prototype:void 0,Xi=Ji?Ji.valueOf:void 0;var Qi=function(t,e,r,n,o,i,c){switch(r){case qi:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case Yi:return!(t.byteLength!=e.byteLength||!i(new Vn(t),new Vn(e)));case Hi:case Mi:case Gi:return ne(+t,+e);case $i:return t.name==e.name&&t.message==e.message;case Ki:case Wi:return t==e+"";case Bi:var u=Ni;case Vi:var a=n&xi;if(u||(u=Fi),t.size!=e.size&&!a)return!1;var s=c.get(t);if(s)return s==e;n|=ki,c.set(t,e);var l=Li(u(t),u(e),n,o,i,c);return c.delete(t),l;case zi:if(Xi)return Xi.call(t)==Xi.call(e)}return!1},Zi=1,tc=Object.prototype.hasOwnProperty;var ec=function(t,e,r,n,o,i){var c=r&Zi,u=Un(t),a=u.length;if(a!=Un(e).length&&!c)return!1;for(var s=a;s--;){var l=u[s];if(!(c?l in e:tc.call(e,l)))return!1}var p=i.get(t);if(p&&i.get(e))return p==e;var f=!0;i.set(t,e),i.set(e,t);for(var d=c;++s<a;){var h=t[l=u[s]],b=e[l];if(n)var v=c?n(b,h,l,e,t,i):n(h,b,l,t,e,i);if(!(void 0===v?h===b||o(h,b,r,n,i):v)){f=!1;break}d||(d="constructor"==l)}if(f&&!d){var y=t.constructor,_=e.constructor;y!=_&&"constructor"in t&&"constructor"in e&&!("function"==typeof y&&y instanceof y&&"function"==typeof _&&_ instanceof _)&&(f=!1)}return i.delete(t),i.delete(e),f},rc=1,nc="[object Arguments]",oc="[object Array]",ic="[object Object]",cc=Object.prototype.hasOwnProperty;var uc=function(t,e,r,n,o,i){var c=Mr(t),u=Mr(e),a=c?oc:Bn(t),s=u?oc:Bn(e),l=(a=a==nc?ic:a)==ic,p=(s=s==nc?ic:s)==ic,f=a==s;if(f&&Br(t)){if(!Br(e))return!1;c=!0,l=!1}if(f&&!l)return i||(i=new Rr),c||Zr(t)?Li(t,e,r,n,o,i):Qi(t,e,a,r,n,o,i);if(!(r&rc)){var d=l&&cc.call(t,"__wrapped__"),h=p&&cc.call(e,"__wrapped__");if(d||h){var b=d?t.value():t,v=h?e.value():e;return i||(i=new Rr),o(b,v,r,n,i)}}return!!f&&(i||(i=new Rr),ec(t,e,r,n,o,i))};var ac=function t(e,r,n,o,i){return e===r||(null==e||null==r||!Dr(e)&&!Dr(r)?e!=e&&r!=r:uc(e,r,n,o,t,i))},sc=1,lc=2;var pc=function(t,e,r,n){var o=r.length,i=o,c=!n;if(null==t)return!i;for(t=Object(t);o--;){var u=r[o];if(c&&u[2]?u[1]!==t[u[0]]:!(u[0]in t))return!1}for(;++o<i;){var a=(u=r[o])[0],s=t[a],l=u[1];if(c&&u[2]){if(void 0===s&&!(a in t))return!1}else{var p=new Rr;if(n)var f=n(s,l,a,t,e,p);if(!(void 0===f?ac(l,s,sc|lc,n,p):f))return!1}}return!0};var fc=function(t){return t==t&&!De(t)};var dc=function(t){for(var e=ln(t),r=e.length;r--;){var n=e[r],o=t[n];e[r]=[n,o,fc(o)]}return e};var hc=function(t,e){return function(r){return null!=r&&r[t]===e&&(void 0!==e||t in Object(r))}};var bc=function(t){var e=dc(t);return 1==e.length&&e[0][2]?hc(e[0][0],e[0][1]):function(r){return r===t||pc(r,t,e)}};var vc=function(t,e){return null!=t&&e in Object(t)};var yc=function(t,e,r){for(var n=-1,o=(e=li(e,t)).length,i=!1;++n<o;){var c=fi(e[n]);if(!(i=null!=t&&r(t,c)))break;t=t[c]}return i||++n!=o?i:!!(o=null==t?0:t.length)&&zr(o)&&Vr(c,o)&&(Mr(t)||Hr(t))};var _c=function(t,e){return null!=t&&yc(t,e,vc)},mc=1,Ec=2;var Sc=function(t,e){return Jo(t)&&fc(e)?hc(fi(t),e):function(r){var n=hi(r,t);return void 0===n&&n===e?_c(r,t):ac(e,n,mc|Ec)}};var gc=function(t){return t};var Tc=function(t){return function(e){return null==e?void 0:e[t]}};var Ac=function(t){return function(e){return di(e,t)}};var Rc=function(t){return Jo(t)?Tc(fi(t)):Ac(t)};var Ic=function(t){return"function"==typeof t?t:null==t?gc:"object"==typeof t?Mr(t)?Sc(t[0],t[1]):bc(t):Rc(t)};var wc=function(t,e){return gi(t,Ic(e,3),Ai)};var Oc=function(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)},Cc=Math.max;var Uc=function(t,e,r){return e=Cc(void 0===e?t.length-1:e,0),function(){for(var n=arguments,o=-1,i=Cc(n.length-e,0),c=Array(i);++o<i;)c[o]=n[e+o];o=-1;for(var u=Array(e+1);++o<e;)u[o]=n[o];return u[e]=r(c),Oc(t,this,u)}};var Pc=function(t){return function(){return t}},jc=wr?function(t,e){return wr(t,"toString",{configurable:!0,enumerable:!1,value:Pc(e),writable:!0})}:gc,Dc=800,Lc=16,Nc=Date.now;var Fc=function(t){var e=0,r=0;return function(){var n=Nc(),o=Lc-(n-r);if(r=n,o>0){if(++e>=Dc)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}(jc);var xc=function(t,e){return Fc(Uc(t,e,gc),t+"")};var kc=function(t,e,r){(void 0===r||ne(t[e],r))&&(void 0!==r||e in t)||Or(t,e,r)};var Hc=function(t){return Dr(t)&&sn(t)},Mc="[object Object]",$c=Function.prototype,Bc=Object.prototype,Gc=$c.toString,Kc=Bc.hasOwnProperty,Vc=Gc.call(Object);var Wc=function(t){if(!Dr(t)||je(t)!=Mc)return!1;var e=In(t);if(null===e)return!0;var r=Kc.call(e,"constructor")&&e.constructor;return"function"==typeof r&&r instanceof r&&Gc.call(r)==Vc};var zc=function(t,e){if("__proto__"!=e)return t[e]};var Yc=function(t){return Pr(t,bn(t))};var qc=function(t,e,r,n,o,i,c){var u=zc(t,r),a=zc(e,r),s=c.get(a);if(s)kc(t,r,s);else{var l=i?i(u,a,r+"",t,e,c):void 0,p=void 0===l;if(p){var f=Mr(a),d=!f&&Br(a),h=!f&&!d&&Zr(a);l=a,f||d||h?Mr(u)?l=u:Hc(u)?l=_n(u):d?(p=!1,l=yn(a,!0)):h?(p=!1,l=Zn(a,!0)):l=[]:Wc(a)||Hr(a)?(l=u,Hr(u)?l=Yc(u):De(u)&&!He(u)||(l=To(a))):p=!1}p&&(c.set(a,l),o(l,a,n,i,c),c.delete(a)),kc(t,r,l)}};var Jc=function t(e,r,n,o,i){e!==r&&Ti(r,function(c,u){if(De(c))i||(i=new Rr),qc(e,r,u,n,t,o,i);else{var a=o?o(zc(e,u),c,u+"",e,r,i):void 0;void 0===a&&(a=c),kc(e,u,a)}},bn)};var Xc=function t(e,r,n,o,i,c){return De(e)&&De(r)&&(c.set(r,e),Jc(e,r,void 0,t,c),c.delete(r)),e};var Qc=function(t,e,r){if(!De(r))return!1;var n=typeof e;return!!("number"==n?sn(r)&&Vr(e,r.length):"string"==n&&e in r)&&ne(r[e],t)};var Zc=function(t){return xc(function(e,r){var n=-1,o=r.length,i=o>1?r[o-1]:void 0,c=o>2?r[2]:void 0;for(i=t.length>3&&"function"==typeof i?(o--,i):void 0,c&&Qc(r[0],r[1],c)&&(i=o<3?void 0:i,o=1),e=Object(e);++n<o;){var u=r[n];u&&t(e,u,n,i)}return e})}(function(t,e,r,n){Jc(t,e,r,n)}),tu=xc(function(t){return t.push(void 0,Xc),Oc(Zc,void 0,t)});function eu(t){let e={};for(let r in t)if(t.hasOwnProperty(r)&&_i(r)&&t[r]){e=ee({},e,{[r]:JSON.parse(t[r])})}return e}var ru=function(t,e){var r={};return e=Ic(e,3),Ai(t,function(t,n,o){Or(r,n,e(t,n,o))}),r};class nu{static createState(t){return{recordActive:!1,notifications:{},notificationsCounter:0,autoSaveEnabled:!1,isPriceUpdateEnabled:!1,isStopFollowEnabled:!1,selection:null,name:null,isSimilarElementHighlighted:!1,originalBackgroundColor:null,isCurrentPageTracked:!1,faviconURL:null,_faviconURLMap:{},currentURL:null,canonicalURL:null,browserURL:null,domain:null,_sortItemsBy:t,_undoRemovedItems:[],_undoRemovedItemsResetTask:null}}static toggleRecord(t){return ee({},t,{recordActive:!t.recordActive})}static disableRecord(t){return ee({},t,{recordActive:!1})}static enableStopFollow(t){return ee({},t,{isStopFollowEnabled:!0})}static disableStopFollow(t){return ee({},t,{isStopFollowEnabled:!1})}static updateCurrentDomain(t,e){return ee({},t,{domain:e})}static updateCurrentURL(t,e){return ee({},t,{currentURL:e})}static updateCanonicalURL(t,e){return ee({},t,{canonicalURL:e})}static updateBrowserURL(t,e){return ee({},t,{browserURL:e})}static enableCurrentPageTracked(t){return ee({},t,{isCurrentPageTracked:!0})}static disableCurrentPageTracked(t){return ee({},t,{isCurrentPageTracked:!1})}static updateFaviconURL(t,e){return ee({},t,{faviconURL:e})}static updateFaviconURLMapItem(t,e,r){return ee({},t,{_faviconURLMap:ee({},t._faviconURLMap,{[e]:r})})}static enableAutoSave(t,e){return ee({},t,{autoSaveEnabled:!0,selection:e=e||t.selection})}static disableAutoSave(t){return ee({},t,{autoSaveEnabled:!1})}static enablePriceUpdate(t,e){return ee({},t,{isPriceUpdateEnabled:!0,selection:e})}static disablePriceUpdate(t){return ee({},t,{isPriceUpdateEnabled:!1})}static setSelectionInfo(t,e,r,n,o){return ee({},t,{selection:e,price:r,faviconURL:n,name:o})}static setSimilarElementHighlight(t,e,r){return ee({},t,{isSimilarElementHighlighted:e,originalBackgroundColor:r})}static incrementNotificationsCounter(t){return ee({},t,{notificationsCounter:t.notificationsCounter+1})}static deleteNotificationsItem(t,e){const r=ee({},t);return delete r.notifications[e],r}static updateNotificationsItem(t,e,r){return ee({},t,{notifications:ee({},t.notifications,{[e]:r})})}static updateSortItemsBy(t,e){return ee({},t,{_sortItemsBy:e})}static addUndoRemovedItem(t,e,{timestamp:r},n){const o={url:e,timestamp:r},i=[...t._undoRemovedItems];return i.unshift(o),ee({},t,{_undoRemovedItems:i.slice(0,n)})}static getUndoRemovedItemsHead(t){return t._undoRemovedItems[0]}static removeUndoRemovedItem(t){const e=[...t._undoRemovedItems];return e.shift(),ee({},t,{_undoRemovedItems:e})}static removeUndoRemovedItemByURL(t,e){return ee({},t,{_undoRemovedItems:[...t._undoRemovedItems].filter(({url:t})=>t!==e)})}static resetUndoRemovedItems(t){return ee({},t,{_undoRemovedItems:[]})}static setUndoRemovedItemsResetTask(t,e){return ee({},t,{_undoRemovedItemsResetTask:e})}}let ou=null;class iu{static getState(){return ou}static getState$(){return H(ou)}static initState(t){return ou=nu.createState(t)}static toggleRecord(){return ou=nu.toggleRecord(ou)}static disableRecord(){return ou=nu.disableRecord(ou)}static enableStopFollow(){return ou=nu.enableStopFollow(ou)}static disableStopFollow(){return ou=nu.disableStopFollow(ou)}static updateCurrentDomain(t){return ou=nu.updateCurrentDomain(ou,t)}static updateCurrentURL(t){return ou=nu.updateCurrentURL(ou,t)}static updateCanonicalURL(t){return ou=nu.updateCanonicalURL(ou,t)}static updateBrowserURL(t){return ou=nu.updateBrowserURL(ou,t)}static enableCurrentPageTracked(){return ou=nu.enableCurrentPageTracked(ou)}static disableCurrentPageTracked(){return ou=nu.disableCurrentPageTracked(ou)}static updateFaviconURL(t){return ou=nu.updateFaviconURL(ou,t||null)}static updateFaviconURLMapItem(t,e){return ou=nu.updateFaviconURLMapItem(ou,t,e)}static enableAutoSave(t){return t=t||ou.selection,ou=nu.enableAutoSave(ou,t)}static disableAutoSave(){return ou=nu.disableAutoSave(ou)}static enablePriceUpdate(t){return ou=nu.enablePriceUpdate(ou,t)}static disablePriceUpdate(){return ou=nu.disablePriceUpdate(ou)}static setSelectionInfo(t,e,r,n){return ou=nu.setSelectionInfo(ou,t,e,r,n)}static setSimilarElementHighlight(t,e){return ou=nu.setSimilarElementHighlight(ou,t,e)}static incrementNotificationsCounter(){return ou=nu.incrementNotificationsCounter(ou)}static deleteNotificationsItem(t){return ou=nu.deleteNotificationsItem(ou,t)}static updateNotificationsItem(t,e){return ou=nu.updateNotificationsItem(ou,t,e)}static updateSortItemsBy(t){return ou=nu.updateSortItemsBy(ou,t)}static addUndoRemovedItem(t,e,r){return ou=nu.addUndoRemovedItem(ou,t,e,r)}static getUndoRemovedItemsHead(){return nu.getUndoRemovedItemsHead(ou)}static removeUndoRemovedItem(){return ou=nu.removeUndoRemovedItem(ou)}static removeUndoRemovedItemByURL(t){return ou=nu.removeUndoRemovedItemByURL(ou,t)}static resetUndoRemovedItems(){return ou=nu.resetUndoRemovedItems(ou)}static setUndoRemovedItemsResetTask(t){return ou=nu.setUndoRemovedItemsResetTask(ou,t)}static toStorageLocalStateFormat(t){return Object.keys(t).reduce((e,r)=>ee({},e,{[r]:JSON.stringify(t[r])}),{})}static toStorageSyncStateFormat(t){return ru(t,t=>JSON.stringify(t))}static getNotifications$(){return iu.getState$().pipe(V(t=>t.notifications),Ot(1))}static getNotification$(t){return iu.getState$().pipe(V(e=>e.notifications[t]),Ot(1))}}function cu(){return dt(t=>{chrome.storage.local.get(null,t)}).pipe(Ot(1))}function uu(t){const e=Vo(t);return delete e._domain,e}function au(t){const e=Go(t);return delete e._isPathEnoughToTrack,delete e._canUseCanonical,e}function su(t){return bt(t).pipe(Lt(0),Nt(()=>cu()),V(eu),Nt(t=>{const e=Go(t);return dt(t=>{chrome.storage.sync.get(null,t)}).pipe(Ot(1)).pipe(Nt(t=>{for(let r in t)if(t.hasOwnProperty(r)){const n=t[r];n.hasOwnProperty("_domain")&&_i(n._domain)&&(e[n._domain]?(!hi(e,[n._domain,r],null)||n.lastUpdateTimestamp>e[n._domain][r].lastUpdateTimestamp)&&(e[n._domain][r]=uu(n)):e[n._domain]={[r]:uu(n)})}const r=function(t){return Object.keys(t).reduce((e,r)=>{if(_i(r)){const n=Object.keys(t[r]).reduce((t,e)=>mi(e)?ee({[e]:{_domain:r}},t):t,{});return ee({},n,e)}return e},{})}(e),n=function(t,e,r){const n=Object.keys(t).reduce((e,n)=>ee({},r(t[n]),e),{});return tu(n,e)}(e,r,au);return pt(function(t){return dt(e=>{chrome.storage.local.set(t,e)}).pipe(Ot(1))}(iu.toStorageLocalStateFormat(e)),function(t){return dt(e=>{chrome.storage.sync.set(t,e)}).pipe(Ot(1))}(iu.toStorageSyncStateFormat(n)))}))}))}function lu(t){chrome.runtime.onInstalled.addListener(t)}function pu(t){chrome.tabs.onUpdated.addListener(t)}function fu(t){chrome.tabs.query({active:!0,currentWindow:!0},t)}function du(){return dt(fu).pipe(Ot(1))}function hu(t){chrome.tabs.onActivated.addListener(t)}function bu(){return dt(hu).pipe(Nt(()=>du()),V(([{id:t,url:e}])=>({id:t,url:e})))}function vu(t){chrome.webNavigation.onCompleted.addListener(t)}function yu(t){chrome.webNavigation.onHistoryStateUpdated.addListener(t)}function _u(){const t=du().pipe(gt(t=>t.length>0));return yt(dt(vu).pipe(V(({frameId:t})=>t)).pipe(gt(t=>0===t),Nt(()=>t),V(([{id:t,url:e}])=>({id:t,url:e}))),dt(yu).pipe(Nt(()=>t),V(([{id:t,url:e}])=>({id:t,url:e})),Nt(t=>(function(t,e){const{url:r}=e;return t().pipe(V(({browserURL:t})=>t),gt(t=>void 0!==r&&r!==t),V(()=>e))})(iu.getState$,t))))}function mu(t){chrome.notifications.onButtonClicked.addListener(t)}const Eu={WATCHED:"WATCHED",NOT_FOUND:"NOT_FOUND",INCREASED:"INCREASED",DECREASED:"DECREASED",ACK_DECREASE:"ACK_DECREASE",ACK_INCREASE:"ACK_INCREASE",FIXED:"FIXED"},Su=Object.values(Eu);var gu={WATCHED:Eu.WATCHED,NOT_FOUND:Eu.NOT_FOUND,INCREASED:Eu.INCREASED,DECREASED:Eu.DECREASED,ACK_DECREASE:Eu.ACK_DECREASE,ACK_INCREASE:Eu.ACK_INCREASE,FIXED:Eu.FIXED,ALL_STATUSES:Su};function Tu(t){return dt(e=>{chrome.storage.local.get([t],e)}).pipe(Ot(1),V(e=>(function(t,e){return t&&t[e]?JSON.parse(t[e]):{}})(e,t)))}var Au=function(t,e,r,n){for(var o=t.length,i=r+(n?1:-1);n?i--:++i<o;)if(e(t[i],i,t))return i;return-1};var Ru=function(t){return t!=t};var Iu=function(t,e,r){for(var n=r-1,o=t.length;++n<o;)if(t[n]===e)return n;return-1};var wu=function(t,e,r){return e==e?Iu(t,e,r):Au(t,Ru,r)};var Ou=function(t,e){return!(null==t||!t.length)&&wu(t,e,0)>-1};var Cu=function(t,e,r){for(var n=-1,o=null==t?0:t.length;++n<o;)if(r(e,t[n]))return!0;return!1};var Uu=function(){},Pu=Ln&&1/Fi(new Ln([,-0]))[1]==1/0?function(t){return new Ln(t)}:Uu,ju=200;var Du=function(t,e,r){var n=-1,o=Ou,i=t.length,c=!0,u=[],a=u;if(r)c=!1,o=Cu;else if(i>=ju){var s=e?null:Pu(t);if(s)return Fi(s);c=!1,o=Pi,a=new Ci}else a=e?[]:u;t:for(;++n<i;){var l=t[n],p=e?e(l):l;if(l=r||0!==l?l:0,c&&p==p){for(var f=a.length;f--;)if(a[f]===p)continue t;e&&a.push(p),u.push(l)}else o(a,p,r)||(a!==u&&a.push(p),u.push(l))}return u};var Lu=function(t){return t&&t.length?Du(t):[]};class Nu{constructor(t,e,r,n,o,i,c=null,u=e,a,s){this.selection=t,this.price=e,this.currentPrice=u,this.startingPrice=e,this.previousPrice=r||null,this.faviconURL=n,this.name=o,this.timestamp=a||(new Date).getTime(),this.lastUpdateTimestamp=s||(new Date).getTime(),this.statuses=i,this.diffPercentage=c}updateCurrentPrice(t){return this.previousPrice=this.currentPrice,this.currentPrice=t,this.updateDiffPercentage()}updateDiffPercentage(){const t=100*Math.abs(this.currentPrice-this.price)/this.price,e=parseFloat(t.toFixed(2));let r=null;e&&((r=this.currentPrice>this.price?+e:-e)>0&&r<1?r=Math.ceil(r):r>-1&&r<0&&(r=Math.floor(r))),this.diffPercentage=r}updateTrackStatus(t,e,r,n=!1){e||(e=[]),r||(r=[]),this.statuses=Lu([...this.removeStatuses(r),...e]),this.lastUpdateTimestamp=(new Date).getTime(),n&&(this.startingPrice=this.price),t&&(this.price=t)}removeStatuses(t=[]){return t.length>0&&this.statuses.length>0?this.statuses.filter(e=>!t.includes(e)):this.statuses}isWatched(){return this.statuses.includes(gu.WATCHED)}isNotFound(){return this.statuses.includes(gu.NOT_FOUND)}hasAcknowledgeDecrease(){return this.statuses.includes(gu.ACK_DECREASE)}hasAcknowledgeIncrease(){return this.statuses.includes(gu.ACK_INCREASE)}}class Fu{static createItem(t,e,r,n,o,i,c){return new Nu(t,e,r,n,o,i,c)}static createItemFromObject({selection:t,price:e,previousPrice:r,faviconURL:n,name:o,statuses:i,diffPercentage:c,currentPrice:u,timestamp:a,lastUpdateTimestamp:s}){return new Nu(t,e,r,n,o,i,c,u,a,s)}}function xu(t,e){return dt(r=>{chrome.storage.local.set({[t]:JSON.stringify(e)},r)}).pipe(Ot(1))}const ku=[{[gu.DECREASED]:Hu,[gu.INCREASED]:Hu},{[gu.DECREASED]:function(t){return t.updateTrackStatus(t.price,null,[gu.DECREASED,gu.ACK_DECREASE],!0),t},[gu.INCREASED]:function(t){return t.updateTrackStatus(t.previousPrice,null,[gu.INCREASED,gu.ACK_INCREASE],!0),t}}];function Hu(t){return t.updateTrackStatus(null,null,gu.ALL_STATUSES),t}function Mu(){return dt(mu).pipe(V(([t,e])=>({notificationId:t,buttonIndex:e}))).pipe(Nt(({notificationId:t,buttonIndex:e})=>iu.getNotification$(t).pipe(V(t=>({notification:t,buttonIndex:e})))),Nt(({notification:t,buttonIndex:e})=>{const{domain:r,url:n,type:o}=t;return Tu(r).pipe(gt(t=>t[n]),V(t=>({domainState:t,domain:r,url:n,type:o,buttonIndex:e})))}),Nt(({domainState:t,domain:e,url:r,type:n,buttonIndex:o})=>{const i=Fu.createItemFromObject(t[r]),c=hi(ku,[o,n]);return He(c)?(t[r]=c(i),xu(e,t).pipe(V(()=>(function(t){return 0===t})(o)))):H()}))}function $u(t){chrome.notifications.onClosed.addListener(t)}var Bu="[object Map]",Gu="[object Set]",Ku=Object.prototype.hasOwnProperty;var Vu=function(t){if(null==t)return!0;if(sn(t)&&(Mr(t)||"string"==typeof t||"function"==typeof t.splice||Br(t)||Zr(t)||Hr(t)))return!t.length;var e=Bn(t);if(e==Bu||e==Gu)return!t.size;if(nn(t))return!an(t).length;for(var r in t)if(Ku.call(t,r))return!1;return!0};const Wu={[gu.DECREASED]:function(t){return t.updateTrackStatus(null,[gu.ACK_DECREASE]),t},[gu.INCREASED]:function(t){return t.updateTrackStatus(null,[gu.ACK_INCREASE]),t}};function zu(t,e){return function(t){return dt(e=>{chrome.notifications.clear(t,e)}).pipe(Ot(1))}(t).pipe(V(r=>({notificationId:t,wasClosedByUser:e,wasClickedByUser:r})),Nt(({notificationId:t,wasClosedByUser:e,wasClickedByUser:r})=>r||e?iu.getNotification$(t):H()),Rt(()=>{iu.deleteNotificationsItem(t)}),gt(t=>!Vu(t)),Nt(t=>{const{domain:e}=t;return Tu(e).pipe(V(r=>{const{url:n,type:o}=t,i=Fu.createItemFromObject(r[n]),c=hi(Wu,[o]);return He(c)?(r[n]=c(i),xu(e,r)):H()}))}))}function Yu(){return dt($u).pipe(V(([t,e])=>({notificationId:t,wasClosedByUser:e}))).pipe(Nt(({notificationId:t,wasClosedByUser:e})=>zu(t,e)))}function qu(t){chrome.notifications.onClicked.addListener(t)}function Ju(){return dt(qu).pipe(Nt(t=>iu.getNotifications$().pipe(Nt(e=>yt(function(t){return dt(e=>{chrome.tabs.create({url:t},e)}).pipe(Ot(1))}(e[t].url),zu(t))))))}function Xu(t){return new Promise((e,r)=>{const n=new XMLHttpRequest;n.addEventListener("load",function(){const t=function(t){const e=document.createElement("template");return e.innerHTML=t.trim(),e.content}(n.response);e(t)}),n.addEventListener("error",r),n.open("GET",t),n.send()})}function Qu(t){return it(Xu(t)).pipe(Ot(1))}function Zu(t,e,r){return Tu(e).pipe(V(e=>{const n=e[t]&&Fu.createItemFromObject(e[t]),o=e[r]&&Fu.createItemFromObject(e[r]),i=n&&n.isWatched()||o&&o.isWatched();if(e&&!i){const t=function(t){return wc(t,(t,e)=>mi(e))}(e),r=e[t]&&Fu.createItemFromObject(e[t]);if(r&&r.selection)return{enable:!0,selection:r.selection}}return{enable:!1}}),Ot(1))}function ta(t,e,r,n){return!0===r?H(!0):!1===r?H(!1):r?void 0:Tu(t).pipe(V(t=>{if(!Vu(t)){const r=t[e]||t[n],o=r&&Fu.createItemFromObject(r);if(o&&o.isWatched())return!0}return!1}),Ot(1))}function ea(t,e,r,n){return pt(Zu(t,e,n),function(t,e,r){return Tu(e).pipe(V(e=>{const n=e[t]&&Fu.createItemFromObject(e[t])||e[r]&&Fu.createItemFromObject(e[r]);return n&&n.price!==n.currentPrice?{enable:!0,selection:n.selection}:{enable:!1}}),Ot(1))}(t,e,n),ta(e,t,r,n))}function ra(t,e){const r=function(t){const e=t.match(bi.CAPTURE.DOMAIN_IN_URL);if(e){const[,t]=e;return t}return null}(e);return r?(iu.updateCurrentDomain(r),Tu(r).pipe(Nt(t=>{if(t&&!1===t._canUseCanonical){if(iu.updateCanonicalURL(null),iu.updateCurrentURL(e),iu.updateBrowserURL(e),!0===t._isPathEnoughToTrack){const t=Si(e);t&&(iu.updateCurrentURL(t),iu.updateBrowserURL(t))}const{currentURL:r,domain:n}=iu.getState();return ea(r,n,null,e)}return iu.updateBrowserURL(e),Qu(e).pipe(Nt(r=>{const n=function(t){const e=t.querySelector('link[rel="canonical"]');return e&&e.getAttribute("href")}(r);if(yi(n))iu.updateCurrentURL(n),iu.updateCanonicalURL(n);else if(iu.updateCanonicalURL(null),iu.updateCurrentURL(e),t&&!0===t._isPathEnoughToTrack){const t=Si(e);t&&(iu.updateCurrentURL(t),iu.updateBrowserURL(t))}const{currentURL:o,domain:i}=iu.getState();return ea(o,i,null,e)}))}))):H()}function na(t){const e=(e,r,n)=>(t(e,r,n),!0);return chrome.runtime.onMessage.addListener(e),e}function oa(t,e){return dt(na).pipe(gt(([{type:e}])=>e===t),V(([t,e,r])=>({payload:t,sender:e,sendResponse$:function(t){return e=>H(t(e)).pipe(Ot(1))}(r)})),ct(e))}function ia(t,e){return dt(r=>{chrome.tabs.sendMessage(t,e,r)}).pipe(Ot(1))}function ca(t,e){return Tu(e).pipe(V(e=>{return(Vu(e)||void 0===e._canUseCanonical)&&!!t.canonicalURL&&t.canonicalURL!==t.browserURL}))}const{CONFIRMATION_DISPLAY_CREATE:ua,CONFIRMATION_DISPLAY_LOAD:aa,CONFIRMATION_DISPLAY_REMOVE:sa}=Wt;function la(t,e){return ia(t,{type:ua,payload:{elementId:"price-tag--url-confirmation"}}).pipe(gt(({status:t})=>1===t),Nt(()=>{const{canonicalURL:r,browserURL:n}=iu.getState(),o=function(t,e,r){return{title:"This website recommends to follow this item through a different URL",message:`<u>${r}</u> says that a more accurate URL for this item would be:<br>`+`<i><a href="${t}" target="_blank"  rel="noopener noreferrer">${t}</a></i><br>`+"If this is correct, we recommend you to follow it.<br><br><b>However</b> you can still opt to choose following the current browser URL:<br>"+`<i><a href="${e}" target="_blank" rel="noopener noreferrer">${e}</a></i><br><br>`+"Since your choice will affect the way items are tracked in this site futurely,<br>please help us helping you by choosing carefully one of the following options:",buttons:["Use recommended URL. Remember this option for this site","Use recommended URL but just this time","It's not correct, use the current browser URL. Remember this option","Don't use recommended URL. Use the current browser URL instead but just this time"]}}(r,n,e);return ia(t,{type:aa,payload:o}).pipe(Nt(({status:r,index:n})=>{const o=ia(t,{type:sa,payload:{elementId:"price-tag--url-confirmation"}}),{canonicalURL:i,browserURL:c}=iu.getState();switch(r){case 1:switch(n){case 0:return Tu(e).pipe(Nt(t=>{t._canUseCanonical=!0;const{canonicalURL:r}=iu.getState();return iu.updateCurrentURL(r),pt(o,xu(e,t))}),Pt([!0,!0]));case 1:return iu.updateCurrentURL(i),o.pipe(Pt([!0,!0]));case 2:return Tu(e).pipe(Nt(t=>{t._canUseCanonical=!1;const{browserURL:r}=iu.getState();return iu.updateCurrentURL(r),pt(o,xu(e,t))}),Pt([!0,!1]));case 3:return iu.updateCurrentURL(c),o.pipe(Pt([!0,!1]));default:return o.pipe(Pt([!1]))}default:return o.pipe(Pt([!1]))}}))}))}function pa(t,e){const r=Ei(e);for(let n in t)if(t.hasOwnProperty(n)&&mi(n)){if(Fu.createItemFromObject(t[n]).isWatched()){if(e===n)return null;if(Ei(n)===r)return n}}return null}function fa(t,e,r){return Tu(e).pipe(Nt(n=>{if(Vu(n))return H([r,!0]);if(!0===n._isPathEnoughToTrack){return H(pa(n,r)?[r,!1,!1]:[r,!0])}if(!1===n._isPathEnoughToTrack)return H([r,!0]);{const o=pa(n,r);if(o){const i="price-tag--save-confirmation";return ia(t,{type:"CONFIRMATION_DISPLAY.CREATE",payload:{elementId:i}}).pipe(Nt(({status:c})=>{if(1===c){const c=function(t,e){return{title:"Item with similar URL to existing one",message:"It appears that the item URL you're trying to save:<br>"+`<i><a href="${t}" target="_blank" rel="noopener noreferrer">${t}</a></i><br>`+"is pretty similar to<br>"+`<i><a href="${e}" target="_blank" rel="noopener noreferrer">${e}</a></i><br><br>`+"Since your choice will affect the way items are tracked in this site futurely,<br>please help us helping you by choosing carefully one of the following options:",buttons:["It's not, save it! Remember this option for this site.","Don't save. Ask me again for items of this site!","Indeed the same item. Don't save! Remember this option for this site. (Use just URL path for accessing items)","For now save this item. Ask me again next time!"]}}(r,o);return ia(t,{type:"CONFIRMATION_DISPLAY.LOAD",payload:c}).pipe(Nt(({status:o,index:c})=>{const u=ia(t,{type:"CONFIRMATION_DISPLAY.REMOVE",payload:{elementId:i}});switch(o){case 1:switch(c){case 0:return n._isPathEnoughToTrack=!1,chrome.storage.local.set({[e]:JSON.stringify(n)}),u.pipe(Pt([r,!0]));case 1:return u.pipe(Pt([r,!1,!0]));case 2:return n._isPathEnoughToTrack=!0,pt(u,xu(e,n)).pipe(Pt([r,!1,!1]));case 3:return u.pipe(Pt([r,!0]));default:return u.pipe(Pt([r,!1,!0]))}case 2:default:return u.pipe(Pt([r,!1,!0]))}}))}return H([r,!1,!0])}))}return H([r,!0])}}))}function da(t,e,r,n,o,i,c){return Tu(t).pipe(Nt(u=>(u[e]=Fu.createItem(r,vi(n),null,o,i,c),xu(t,u).pipe(Rt(iu.disableAutoSave)))))}const ha="Attempting to use a disconnected port object";var ba={TIME:function({timestamp:t},{timestamp:e}){return t-e},CURRENT_PRICE:function({currentPrice:t},{currentPrice:e}){return t-e}};function va(t){return cu().pipe(V(e=>{let r=[];Object.keys(e).forEach(t=>{if(_i(t)){const n=e[t],o=JSON.parse(n)||null;if(o){let t=[];Object.keys(o).forEach(e=>{if(function(t){return bi.HOSTNAME.test(t)}(e)){const r=Fu.createItemFromObject(o[e]);r.isWatched()&&t.push(ee({},r,{url:e}))}}),r=[...r,...t]}}});const n=ba[t];return r.sort(n),r}))}function ya(t){return dt(e=>{chrome.runtime.sendMessage(t,t=>e(t))}).pipe(Ot(1))}const{TRACKED_ITEMS_SET_UNDO_STATUS:_a}=Wt;function ma(t,e,r){return cu().pipe(Nt(n=>{const o=Object.keys(n);for(let i=0;i<o.length;i++){const c=o[i];if(_i(c)){const o=n[c],i=JSON.parse(o)||null,u=i[t]&&Fu.createItemFromObject(i[t]);if(u){const{_undoRemovedItemsResetTask:n}=iu.getState();n&&(clearTimeout(n),iu.setUndoRemovedItemsResetTask(null));const o=ee({},u);return iu.addUndoRemovedItem(t,o,Bt),ya({type:_a,payload:{isUndoStatusActive:!0}}).pipe(Rt(()=>{const t=setTimeout(()=>{iu.resetUndoRemovedItems(),chrome.runtime.sendMessage({type:_a,payload:{isUndoStatusActive:!1}})},Gt);iu.setUndoRemovedItemsResetTask(t)}),Nt(()=>(u.updateTrackStatus(null,null,[gu.WATCHED]),i[t]=u,xu(c,i).pipe(Nt(()=>e===t||r===t?ea(t,c,!1,r):H(void 0))))))}}}return H(void 0)}))}function Ea(t=[]){if(!Vu(t)){const[e,r,n]=t;if(e){const{enable:t,selection:r}=e;t?iu.enableAutoSave(r):iu.disableAutoSave()}if(r){const{enable:t,selection:e}=r;t?iu.enablePriceUpdate(e):iu.disablePriceUpdate()}n?(Zt(),iu.enableCurrentPageTracked(),iu.enableStopFollow()):(Qt(),iu.disableCurrentPageTracked(),iu.disableStopFollow())}}const{POPUP_STATUS:Sa,RECORD_ATTEMPT:ga,RECORD_START:Ta,RECORD_CANCEL:Aa,AUTO_SAVE_STATUS:Ra,AUTO_SAVE_CHECK_STATUS:Ia,AUTO_SAVE_ATTEMPT:wa,AUTO_SAVE_HIGHLIGHT_PRE_START:Oa,AUTO_SAVE_HIGHLIGHT_PRE_STOP:Ca,PRICE_TAG_HIGHLIGHT_START:Ua,PRICE_TAG_HIGHLIGHT_STOP:Pa,PRICE_UPDATE_STATUS:ja,PRICE_UPDATE_CHECK_STATUS:Da,PRICE_UPDATE_ATTEMPT:La,PRICE_UPDATE_HIGHLIGHT_PRE_START:Na,PRICE_UPDATE_HIGHLIGHT_PRE_STOP:Fa,STOP_FOLLOW_STATUS:xa,STOP_FOLLOW_ATTEMPT:ka,TRACKED_ITEMS_OPEN:Ha,TRACKED_ITEMS_GET:Ma,TRACKED_ITEMS_UNFOLLOW:$a,TRACKED_ITEMS_CHANGE_SORT:Ba,TRACKED_ITEMS_UNDO_ATTEMPT:Ga}=Wt;function Ka(){iu.disableRecord()}function Va({status:t,selection:e,price:r,faviconURL:n,name:o}={}){if(t>=0){const t=iu.getState();return iu.updateFaviconURL(t.faviconURL||n),iu.setSelectionInfo(e,r,t.faviconURL,o),!0}return!1}function Wa(t,e,r,n){return ia(t,{type:Ia,payload:{url:e,selection:r}}).pipe(V(Va),Nt(t=>n(t)))}function za({status:t,isHighlighted:e,originalBackgroundColor:r=null}){t>=0&&iu.setSimilarElementHighlight(e,r)}function Ya(t){t?(Zt(),iu.enableCurrentPageTracked()):(Qt(),iu.disableCurrentPageTracked())}function qa(){return oa(ga,({payload:t,sendResponse$:e})=>{const{payload:r={}}=t,{id:n}=r,{domain:o}=iu.getState(),{recordActive:i}=iu.toggleRecord();let c;if(i){const{url:t}=r;c=ia(n,{type:Ta,payload:{url:t}}).pipe(gt(({status:t})=>t>0),Nt(function(t,e,r,n){const{selection:o,price:i,faviconURL:c,name:u}=n,a=iu.getState();return iu.updateFaviconURL(a.faviconURL||c),iu.disableRecord(),ca(a,r).pipe(Nt(n=>n?la(t,r).pipe(gt(([t])=>t),Nt(([,e])=>{const{canonicalURL:n,browserURL:o}=iu.getState();return fa(t,r,e?n:o)})):fa(t,r,e)),gt(([,t])=>t),Rt(([t])=>iu.removeUndoRemovedItemByURL(t)),Nt(([t])=>pt(da(r,t,o,i,a.faviconURL,u,[gu.WATCHED]),ta(r,t,!0))))}.bind(null,n,t,o)),Rt(([,t])=>{Ya(t)}))}else c=ia(n,{type:Aa}).pipe(Rt(Ka));return pt(c,e({status:1,state:{recordActive:i}})).pipe(V(([,t])=>t))})}function Ja(){return t=(({message:t})=>t===ha?H(!1):D),function(e){var r=new Et(t),n=e.lift(r);return r.caught=n};var t}function Xa(){return oa(ja,({payload:t,sendResponse$:e})=>{const{payload:r={}}=t,{id:n}=r,{domain:o}=iu.getState();return Tu(o).pipe(Nt(t=>{const{currentURL:r,browserURL:o,selection:i}=iu.getState(),c=t[r]&&Fu.createItemFromObject(t[r])||t[o]&&Fu.createItemFromObject(t[o]);return c?ia(n,{type:Da,payload:{selection:i}}).pipe(V(function(t,{status:e,selection:r,price:n,faviconURL:o,name:i}={}){if(e>=0){const e=iu.getState();if(iu.updateFaviconURL(e.faviconURL||o),iu.setSelectionInfo(r,n,e.faviconURL,i),vi(n)!==t)return!0}return!1}.bind(null,c.price)),Nt(t=>e(t))):e(!1)}))})}function Qa(){return oa(Ga,({sendResponse$:t})=>{const{_undoRemovedItems:e}=iu.getState();if(e.length>0){const e=iu.getUndoRemovedItemsHead(),r=iu.getState(),{currentURL:n,browserURL:o}=r;return function(t,e,r){return cu().pipe(Nt(n=>{const o=Object.keys(n);for(let i=0;i<o.length;i++){const c=o[i];if(_i(c)){const o=n[c],i=JSON.parse(o)||null,u=i[t]&&Fu.createItemFromObject(i[t]);if(u)return u.updateTrackStatus(null,[gu.WATCHED],null),i[t]=u,xu(c,i).pipe(Nt(()=>e===t||r===t?ea(t,c,!0,r):H(void 0)))}}return H(void 0)}))}(e.url,n,o).pipe(Rt(Ea),Nt(()=>{const{_undoRemovedItems:e}=iu.removeUndoRemovedItem(r);return 0===e.length?t({isUndoStatusActive:!1}):t({isUndoStatusActive:!0})}))}return t({isUndoStatusActive:!1})})}function Za(t,e,r,n,o="",i,c,u,a={}){return function(t,e){return dt(r=>{chrome.notifications.create(t,e,r)}).pipe(Ot(1))}(t,ee({type:"basic",title:r,message:n,iconUrl:e,contextMessage:o,requireInteraction:!0},a)).pipe(Rt(t=>{iu.incrementNotificationsCounter(),iu.updateNotificationsItem(t,{url:i,domain:c,type:u})}))}function ts(t){return bt(t).pipe(Lt(0),Nt(()=>cu().pipe(gt(t=>t),ct(t=>{const e=Object.keys(t);return _t(0,e.length).pipe(V(t=>e[t]),gt(e=>t.hasOwnProperty(e)&&_i(e)),V(e=>({domain:e,result:t})))}),ct(({domain:t,result:e})=>{const r=JSON.parse(e[t]),n=Object.keys(r);return _t(0,n.length).pipe(V(t=>n[t]),gt(t=>r.hasOwnProperty(t)&&mi(t)),V(e=>({url:e,domainItems:r,domain:t})))}),ct(({url:t,domainItems:e,domain:r})=>{const n=Fu.createItemFromObject(e[t]);return n.isWatched()?Qu(t).pipe(ct(o=>(function(t,e,r,n,o){const{price:i,currentPrice:c}=o;try{let u=null;const{textContent:a}=t.querySelector(n[r].selection);if(a){const t=a.match(bi.PRICE);if(t){if([,u]=t,u=vi(u),!o.price||u)return i?u<c?(o.updateCurrentPrice(u),o.updateTrackStatus(null,u===i?null:[gu.DECREASED],[gu.INCREASED,gu.NOT_FOUND,gu.ACK_DECREASE]),n[r]=o,xu(e,n).pipe(ct(()=>{if(u<i&&!o.hasAcknowledgeDecrease()){const{notificationsCounter:t}=iu.getState();return Za(`TRACK.PRICE_UPDATE-${t}`,qt,"Lower price!!",`${u} (previous ${i})`,r,r,e,gu.DECREASED,{buttons:[{title:"Stop watching"},{title:`Keep tracking but w/ new price (${u})`}]})}return H()}))):u>c?(o.updateCurrentPrice(u),o.updateTrackStatus(null,u===i?null:[gu.INCREASED],[gu.DECREASED,gu.NOT_FOUND,gu.ACK_INCREASE]),n[r]=o,xu(e,n).pipe(ct(()=>{if(!o.hasAcknowledgeIncrease()){const{notificationsCounter:t}=iu.getState(),o=`TRACK.PRICE_UPDATE-${t}`,i={buttons:[{title:"Stop watching"}]};return n[r].price!==n[r].previousPrice&&i.buttons.push({title:`Increase interest price to the previous (${n[r].previousPrice})`}),Za(o,qt,"Price increase",`${u} (previous ${n[r].previousPrice})`,r,r,e,gu.INCREASED,i)}return H()}))):(o.isNotFound(),o.updateTrackStatus(null,null,[gu.NOT_FOUND]),n[r]=o,xu(e,n)):(o.updateTrackStatus(u,[gu.FIXED],[gu.NOT_FOUND]),n[r]=o,xu(e,n).pipe(ct(()=>{const{notificationsCounter:t}=iu.getState();return Za(`TRACK.PRICE_FIXED-${t}`,Xt,"Fixed price",`Ermm.. We've just fixed a wrongly set price to ${u}`,r,r,e)})));if(!o.isNotFound())return o.updateTrackStatus(null,[gu.NOT_FOUND],[gu.DECREASED,gu.INCREASED,gu.FIXED,gu.ACK_DECREASE]),n[r]=o,xu(e,n).pipe(ct(()=>{const{notificationsCounter:t}=iu.getState();return Za(`TRACK.PRICE_NOT_FOUND-${t}`,Jt,"Price gone",`Price tag no longer found${i?` (previous ${i})`:""}`,r,r,e)}))}}}catch(t){return o.isNotFound()?H(t):(console.warn(`Invalid price selection element in\n${r}:\t"${n[r].selection}"`),o.updateTrackStatus(null,[gu.NOT_FOUND],[gu.DECREASED,gu.INCREASED,gu.FIXED,gu.ACK_DECREASE]),n[r]=o,xu(e,n).pipe(ct(()=>{const{notificationsCounter:t}=iu.getState();return Za(`TRACK.PRICE_NOT_FOUND-${t}`,Jt,"Price gone",`Price tag no longer found${i?` (previous ${i})`:""}`,r,r,e)})))}})(o,r,t,e,n))):D}))))}function es(){var t;dt(lu).pipe(Ot(1)).subscribe(()=>console.log("Price tag installed.")),bu().pipe(Nt(({id:t,url:e})=>{if(e.startsWith("http")){const{_faviconURLMap:r}=iu.getState();return iu.updateFaviconURL(r[t]),ra(0,e)}return H(void 0)})).subscribe(Ea),dt(pu).pipe(V(([t,{favIconUrl:e},{active:r,url:n}])=>({tabId:t,favIconUrl:e,active:r,url:n}))).subscribe(({tabId:t,favIconUrl:e,active:r,url:n})=>{n.startsWith("http")?r&&e&&(iu.updateFaviconURLMapItem(t,e),iu.updateFaviconURL(e)):Qt()}),_u().pipe(Nt(({id:t,url:e})=>ra(0,e))).subscribe(Ea),oa(Sa,({sendResponse$:t})=>{const{recordActive:e,autoSaveEnabled:r,isPriceUpdateEnabled:n,isStopFollowEnabled:o}=iu.getState();return t({status:1,state:{recordActive:e,autoSaveEnabled:r,isPriceUpdateEnabled:n,isStopFollowEnabled:o}})}).subscribe(),qa().subscribe(),oa(Ra,({payload:t,sendResponse$:e})=>{const{payload:r={}}=t,{id:n}=r,{domain:o,currentURL:i}=iu.getState();return Tu(o).pipe(Nt(t=>{if(Vu(t)){const{selection:t}=iu.getState();return Wa(n,i,t,e)}if(!0===t._isPathEnoughToTrack){if(pa(t,i))return e({status:-1});{const{selection:t}=iu.getState();return Wa(n,i,t,e)}}{const{selection:t}=iu.getState();return Wa(n,i,t,e)}}))}).subscribe(),oa(Oa,({payload:t})=>{const{payload:e={}}=t,{id:r}=e,{autoSaveEnabled:n}=iu.getState();if(n){const{selection:t}=iu.getState();return ia(r,{type:Ua,payload:{selection:t}}).pipe(Rt(za))}return D}).subscribe(),oa(Ca,({payload:t})=>{const{payload:e={}}=t,{id:r}=e,{autoSaveEnabled:n}=iu.getState();if(n){const{selection:t,originalBackgroundColor:e}=iu.getState();return ia(r,{type:Pa,payload:{selection:t,originalBackgroundColor:e}}).pipe(Rt(za))}return D}).subscribe(),oa(wa,({payload:t,sendResponse$:e})=>{const{payload:r={}}=t,{id:n}=r,{autoSaveEnabled:o,domain:i,currentURL:c}=iu.getState();if(o){const t=iu.getState(),{selection:r,price:o,faviconURL:u,name:a,originalBackgroundColor:s}=t;return ca(t,i).pipe(Nt(l=>l?la(n,i).pipe(gt(([t])=>t),Nt(([,c])=>{const{canonicalURL:l,browserURL:p}=t;return fa(n,i,c?l:p).pipe(Nt(([t,c,l])=>c?(iu.removeUndoRemovedItemByURL(t),da(i,t,r,o,u,a,[gu.WATCHED]).pipe(Rt(iu.disableAutoSave),Nt(()=>pt(ia(n,{type:Pa,payload:{selection:r,originalBackgroundColor:s}}),ta(i,t,!0))),Rt(([t,e])=>{za(t),Ya(e)}),Nt(()=>e({isAutoSaveEnabled:!1,isStopFollowEnabled:!0})),Ja())):(l||iu.disableAutoSave(),e({isAutoSaveEnabled:!1,isStopFollowEnabled:!1}).pipe(Ja()))))})):fa(n,i,c).pipe(gt(([,t])=>t),Rt(([t])=>iu.removeUndoRemovedItemByURL(t)),Nt(([t])=>da(i,t,r,o,u,a,[gu.WATCHED]).pipe(Rt(iu.disableAutoSave),Nt(()=>pt(ia(n,{type:Pa,payload:{selection:r,originalBackgroundColor:s}}),ta(i,t,!0))),Rt(([t,e])=>{za(t),Ya(e)}),Nt(()=>e({isAutoSaveEnabled:!1,isStopFollowEnabled:!0})),Ja())))))}return e({isAutoSaveEnabled:!1,isStopFollowEnabled:!1}).pipe(Ja())}).subscribe(),Xa().subscribe(),oa(La,({payload:t,sendResponse$:e})=>{const{payload:r={}}=t,{id:n}=r,{isPriceUpdateEnabled:o,currentURL:i,domain:c}=iu.getState();if(o){const{selection:t,price:r,originalBackgroundColor:o}=iu.getState(),u=r&&vi(r);return Tu(c).pipe(Nt(r=>{const a=Fu.createItemFromObject(r[i]);return a.updateTrackStatus(u,null,[gu.INCREASED,gu.ACK_INCREASE,gu.DECREASED,gu.INCREASED,gu.DECREASED,gu.ACK_DECREASE,gu.DECREASED,gu.DECREASED,gu.NOT_FOUND]),a.updateDiffPercentage(),r[i]=a,pt(xu(c,r),ia(n,{type:Pa,payload:{selection:t,originalBackgroundColor:o}}).pipe(Rt(za))).pipe(Rt(iu.disablePriceUpdate),Nt(()=>e(!1)),Ja())}))}}).subscribe(),oa(Na,({payload:t})=>{const{payload:e={}}=t,{id:r}=e,{isPriceUpdateEnabled:n}=iu.getState();if(n){const{selection:t}=iu.getState();return ia(r,{type:Ua,payload:{selection:t}}).pipe(Rt(za))}return D}).subscribe(),oa(Fa,({payload:t})=>{const{payload:e={}}=t,{id:r}=e,{isPriceUpdateEnabled:n}=iu.getState();if(n){const{selection:t,originalBackgroundColor:e}=iu.getState();return ia(r,{type:Pa,payload:{selection:t,originalBackgroundColor:e}}).pipe(Rt(za))}return D}).subscribe(),oa(xa,({sendResponse$:t})=>{const{domain:e}=iu.getState();return Tu(e).pipe(Nt(e=>{const{currentURL:r,browserURL:n}=iu.getState(),o=e[r]&&Fu.createItemFromObject(e[r])||e[n]&&Fu.createItemFromObject(e[n]);return o&&o.isWatched()?(iu.enableStopFollow(),t(!0)):(iu.disableStopFollow(),t(!1))}))}).subscribe(),oa(ka,({sendResponse$:t})=>{const{currentURL:e,browserURL:r}=iu.getState();return ma(e,e,r).pipe(Rt(Ea),Nt(()=>{const{autoSaveEnabled:e,isStopFollowEnabled:r}=iu.getState();return t({isAutoSaveEnabled:e,isStopFollowEnabled:r})}))}).subscribe(),(t=kt,oa(Ha,({sendResponse$:e})=>e({isUndoStatusActive:iu.updateSortItemsBy(t)._undoRemovedItems.length>0}))).subscribe(),oa(Ma,({sendResponse$:t})=>{const{_sortItemsBy:e}=iu.getState();return va(e).pipe(Nt(e=>t(e)))}).subscribe(),oa($a,({payload:t,sendResponse$:e})=>{const{payload:r={}}=t,{url:n}=r,{currentURL:o,browserURL:i}=iu.getState();return ma(n,o,i).pipe(Rt(Ea),Nt(t=>e(t)))}).subscribe(),oa(Ba,t=>H(t)).pipe(Rt(({payload:t})=>{const{payload:e={}}=t,{sortByType:r}=e;iu.updateSortItemsBy(Ht[r])}),Nt(({sendResponse$:t})=>t())).subscribe(),Qa().subscribe(),Ju().subscribe(),Mu().pipe(gt(t=>t),Nt(()=>{const{domain:t,currentURL:e,browserURL:r}=iu.getState();return ea(e,t,!1,r)})).subscribe(Ea),Yu().subscribe()}iu.initState(kt),su($t).subscribe(),ts(Mt).subscribe(),es()}();

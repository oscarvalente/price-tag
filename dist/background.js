!function(){"use strict";function t(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function e(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),o.forEach(function(r){t(e,r,n[r])})}return e}const r="TIME";var n=Object.freeze({TIME:r,CURRENT_PRICE:"CURRENT_PRICE"});const o=18e4,i=12e4,s=10,c=12e4,a="Price Tag",u="Price Tag - This item is being tracked",l={WATCHED:"WATCHED",NOT_FOUND:"NOT_FOUND",INCREASED:"INCREASED",DECREASED:"DECREASED",ACK_DECREASE:"ACK_DECREASE",ACK_INCREASE:"ACK_INCREASE",FIXED:"FIXED"},f=Object.values(l);var p={WATCHED:l.WATCHED,NOT_FOUND:l.NOT_FOUND,INCREASED:l.INCREASED,DECREASED:l.DECREASED,ACK_DECREASE:l.ACK_DECREASE,ACK_INCREASE:l.ACK_INCREASE,FIXED:l.FIXED,ALL_STATUSES:f};const h="assets/icon_48.png",d="assets/icon_active_48.png",b="./assets/time-is-money.svg",v="./assets/time.svg",y="./assets/coin.svg";var m={PRICE:/((?:\d+[.,])?\d+(?:[.,]\d+)?)/,HOSTNAME:/https?:\/\/([\w.]+)\/*/,DOMAIN:/^([\w-]+\.)+[\w-]+\w$/,URL:/^https?:\/\/([\w-]+\.)+[\w-]+\w(\/[\w-=.]+)+\/?(\?([\w]+=?[\w-%!@()\\["#\]]+&?)*)?/,CAPTURE:{DOMAIN_IN_URL:/https?:\/\/([\w.]+)\/*/,HOSTNAME_AND_PATH:/^https?:\/\/((?:[\w-]+\.)+[\w-]+\w(?:\/[\w-=.]+)+\/?)/,PROTOCOL_HOSTNAME_AND_PATH:/^(https?:\/\/(?:[\w-]+\.)+[\w-]+\w(?:\/[\w-=.]+)+\/?)/}};function _(){chrome.browserAction.setTitle({title:a}),chrome.browserAction.setIcon({path:h})}function g(){chrome.browserAction.setTitle({title:u}),chrome.browserAction.setIcon({path:d})}function E(t){const e=parseFloat(t.replace(",",".")).toFixed(2);return parseFloat(e)}function S(t){return t&&(e=t,m.CAPTURE.HOSTNAME_AND_PATH.test(e));var e}function R(t){return m.DOMAIN.test(t)}function A(t){return m.URL.test(t)}function T(t){const e=t.match(m.CAPTURE.HOSTNAME_AND_PATH);let r=null;return e&&([,r]=e),r}function O(t){const e=t.match(m.CAPTURE.PROTOCOL_HOSTNAME_AND_PATH);let r=null;return e&&([,r]=e),r}var w=function(t,e,r){var n;return r(t,function(t,r,o){if(e(t,r,o))return n=r,!1}),n};var C=function(t){return function(e,r,n){for(var o=-1,i=Object(e),s=n(e),c=s.length;c--;){var a=s[t?c:++o];if(!1===r(i[a],a,i))break}return e}}();var U=function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n},I="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function P(t,e){return t(e={exports:{}},e.exports),e.exports}var j="object"==typeof I&&I&&I.Object===Object&&I,D="object"==typeof self&&self&&self.Object===Object&&self,N=j||D||Function("return this")(),L=N.Symbol,k=Object.prototype,H=k.hasOwnProperty,F=k.toString,M=L?L.toStringTag:void 0;var x=function(t){var e=H.call(t,M),r=t[M];try{t[M]=void 0}catch(t){}var n=F.call(t);return e?t[M]=r:delete t[M],n},J=Object.prototype.toString;var $=function(t){return J.call(t)},K="[object Null]",G="[object Undefined]",B=L?L.toStringTag:void 0;var z=function(t){return null==t?void 0===t?G:K:B&&B in Object(t)?x(t):$(t)};var W=function(t){return null!=t&&"object"==typeof t},V="[object Arguments]";var Y=function(t){return W(t)&&z(t)==V},X=Object.prototype,q=X.hasOwnProperty,Q=X.propertyIsEnumerable,Z=Y(function(){return arguments}())?Y:function(t){return W(t)&&q.call(t,"callee")&&!Q.call(t,"callee")},tt=Array.isArray;var et=function(){return!1},rt=P(function(t,e){var r=e&&!e.nodeType&&e,n=r&&t&&!t.nodeType&&t,o=n&&n.exports===r?N.Buffer:void 0,i=(o?o.isBuffer:void 0)||et;t.exports=i}),nt=9007199254740991,ot=/^(?:0|[1-9]\d*)$/;var it=function(t,e){var r=typeof t;return!!(e=null==e?nt:e)&&("number"==r||"symbol"!=r&&ot.test(t))&&t>-1&&t%1==0&&t<e},st=9007199254740991;var ct=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=st},at={};at["[object Float32Array]"]=at["[object Float64Array]"]=at["[object Int8Array]"]=at["[object Int16Array]"]=at["[object Int32Array]"]=at["[object Uint8Array]"]=at["[object Uint8ClampedArray]"]=at["[object Uint16Array]"]=at["[object Uint32Array]"]=!0,at["[object Arguments]"]=at["[object Array]"]=at["[object ArrayBuffer]"]=at["[object Boolean]"]=at["[object DataView]"]=at["[object Date]"]=at["[object Error]"]=at["[object Function]"]=at["[object Map]"]=at["[object Number]"]=at["[object Object]"]=at["[object RegExp]"]=at["[object Set]"]=at["[object String]"]=at["[object WeakMap]"]=!1;var ut=function(t){return W(t)&&ct(t.length)&&!!at[z(t)]};var lt=function(t){return function(e){return t(e)}},ft=P(function(t,e){var r=e&&!e.nodeType&&e,n=r&&t&&!t.nodeType&&t,o=n&&n.exports===r&&j.process,i=function(){try{var t=n&&n.require&&n.require("util").types;return t||o&&o.binding&&o.binding("util")}catch(t){}}();t.exports=i}),pt=ft&&ft.isTypedArray,ht=pt?lt(pt):ut,dt=Object.prototype.hasOwnProperty;var bt=function(t,e){var r=tt(t),n=!r&&Z(t),o=!r&&!n&&rt(t),i=!r&&!n&&!o&&ht(t),s=r||n||o||i,c=s?U(t.length,String):[],a=c.length;for(var u in t)!e&&!dt.call(t,u)||s&&("length"==u||o&&("offset"==u||"parent"==u)||i&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||it(u,a))||c.push(u);return c},vt=Object.prototype;var yt=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||vt)};var mt=function(t,e){return function(r){return t(e(r))}}(Object.keys,Object),_t=Object.prototype.hasOwnProperty;var gt=function(t){if(!yt(t))return mt(t);var e=[];for(var r in Object(t))_t.call(t,r)&&"constructor"!=r&&e.push(r);return e};var Et=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)},St="[object AsyncFunction]",Rt="[object Function]",At="[object GeneratorFunction]",Tt="[object Proxy]";var Ot=function(t){if(!Et(t))return!1;var e=z(t);return e==Rt||e==At||e==St||e==Tt};var wt=function(t){return null!=t&&ct(t.length)&&!Ot(t)};var Ct=function(t){return wt(t)?bt(t):gt(t)};var Ut=function(t,e){return t&&C(t,e,Ct)};var It=function(){this.__data__=[],this.size=0};var Pt=function(t,e){return t===e||t!=t&&e!=e};var jt=function(t,e){for(var r=t.length;r--;)if(Pt(t[r][0],e))return r;return-1},Dt=Array.prototype.splice;var Nt=function(t){var e=this.__data__,r=jt(e,t);return!(r<0||(r==e.length-1?e.pop():Dt.call(e,r,1),--this.size,0))};var Lt=function(t){var e=this.__data__,r=jt(e,t);return r<0?void 0:e[r][1]};var kt=function(t){return jt(this.__data__,t)>-1};var Ht=function(t,e){var r=this.__data__,n=jt(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this};function Ft(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Ft.prototype.clear=It,Ft.prototype.delete=Nt,Ft.prototype.get=Lt,Ft.prototype.has=kt,Ft.prototype.set=Ht;var Mt=Ft;var xt=function(){this.__data__=new Mt,this.size=0};var Jt=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r};var $t=function(t){return this.__data__.get(t)};var Kt,Gt=function(t){return this.__data__.has(t)},Bt=N["__core-js_shared__"],zt=(Kt=/[^.]+$/.exec(Bt&&Bt.keys&&Bt.keys.IE_PROTO||""))?"Symbol(src)_1."+Kt:"";var Wt=function(t){return!!zt&&zt in t},Vt=Function.prototype.toString;var Yt=function(t){if(null!=t){try{return Vt.call(t)}catch(t){}try{return t+""}catch(t){}}return""},Xt=/^\[object .+?Constructor\]$/,qt=Function.prototype,Qt=Object.prototype,Zt=qt.toString,te=Qt.hasOwnProperty,ee=RegExp("^"+Zt.call(te).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var re=function(t){return!(!Et(t)||Wt(t))&&(Ot(t)?ee:Xt).test(Yt(t))};var ne=function(t,e){return null==t?void 0:t[e]};var oe=function(t,e){var r=ne(t,e);return re(r)?r:void 0},ie=oe(N,"Map"),se=oe(Object,"create");var ce=function(){this.__data__=se?se(null):{},this.size=0};var ae=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},ue="__lodash_hash_undefined__",le=Object.prototype.hasOwnProperty;var fe=function(t){var e=this.__data__;if(se){var r=e[t];return r===ue?void 0:r}return le.call(e,t)?e[t]:void 0},pe=Object.prototype.hasOwnProperty;var he=function(t){var e=this.__data__;return se?void 0!==e[t]:pe.call(e,t)},de="__lodash_hash_undefined__";var be=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=se&&void 0===e?de:e,this};function ve(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}ve.prototype.clear=ce,ve.prototype.delete=ae,ve.prototype.get=fe,ve.prototype.has=he,ve.prototype.set=be;var ye=ve;var me=function(){this.size=0,this.__data__={hash:new ye,map:new(ie||Mt),string:new ye}};var _e=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t};var ge=function(t,e){var r=t.__data__;return _e(e)?r["string"==typeof e?"string":"hash"]:r.map};var Ee=function(t){var e=ge(this,t).delete(t);return this.size-=e?1:0,e};var Se=function(t){return ge(this,t).get(t)};var Re=function(t){return ge(this,t).has(t)};var Ae=function(t,e){var r=ge(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this};function Te(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Te.prototype.clear=me,Te.prototype.delete=Ee,Te.prototype.get=Se,Te.prototype.has=Re,Te.prototype.set=Ae;var Oe=Te,we=200;var Ce=function(t,e){var r=this.__data__;if(r instanceof Mt){var n=r.__data__;if(!ie||n.length<we-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new Oe(n)}return r.set(t,e),this.size=r.size,this};function Ue(t){var e=this.__data__=new Mt(t);this.size=e.size}Ue.prototype.clear=xt,Ue.prototype.delete=Jt,Ue.prototype.get=$t,Ue.prototype.has=Gt,Ue.prototype.set=Ce;var Ie=Ue,Pe="__lodash_hash_undefined__";var je=function(t){return this.__data__.set(t,Pe),this};var De=function(t){return this.__data__.has(t)};function Ne(t){var e=-1,r=null==t?0:t.length;for(this.__data__=new Oe;++e<r;)this.add(t[e])}Ne.prototype.add=Ne.prototype.push=je,Ne.prototype.has=De;var Le=Ne;var ke=function(t,e){for(var r=-1,n=null==t?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1};var He=function(t,e){return t.has(e)},Fe=1,Me=2;var xe=function(t,e,r,n,o,i){var s=r&Fe,c=t.length,a=e.length;if(c!=a&&!(s&&a>c))return!1;var u=i.get(t);if(u&&i.get(e))return u==e;var l=-1,f=!0,p=r&Me?new Le:void 0;for(i.set(t,e),i.set(e,t);++l<c;){var h=t[l],d=e[l];if(n)var b=s?n(d,h,l,e,t,i):n(h,d,l,t,e,i);if(void 0!==b){if(b)continue;f=!1;break}if(p){if(!ke(e,function(t,e){if(!He(p,e)&&(h===t||o(h,t,r,n,i)))return p.push(e)})){f=!1;break}}else if(h!==d&&!o(h,d,r,n,i)){f=!1;break}}return i.delete(t),i.delete(e),f},Je=N.Uint8Array;var $e=function(t){var e=-1,r=Array(t.size);return t.forEach(function(t,n){r[++e]=[n,t]}),r};var Ke=function(t){var e=-1,r=Array(t.size);return t.forEach(function(t){r[++e]=t}),r},Ge=1,Be=2,ze="[object Boolean]",We="[object Date]",Ve="[object Error]",Ye="[object Map]",Xe="[object Number]",qe="[object RegExp]",Qe="[object Set]",Ze="[object String]",tr="[object Symbol]",er="[object ArrayBuffer]",rr="[object DataView]",nr=L?L.prototype:void 0,or=nr?nr.valueOf:void 0;var ir=function(t,e,r,n,o,i,s){switch(r){case rr:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case er:return!(t.byteLength!=e.byteLength||!i(new Je(t),new Je(e)));case ze:case We:case Xe:return Pt(+t,+e);case Ve:return t.name==e.name&&t.message==e.message;case qe:case Ze:return t==e+"";case Ye:var c=$e;case Qe:var a=n&Ge;if(c||(c=Ke),t.size!=e.size&&!a)return!1;var u=s.get(t);if(u)return u==e;n|=Be,s.set(t,e);var l=xe(c(t),c(e),n,o,i,s);return s.delete(t),l;case tr:if(or)return or.call(t)==or.call(e)}return!1};var sr=function(t,e){for(var r=-1,n=e.length,o=t.length;++r<n;)t[o+r]=e[r];return t};var cr=function(t,e,r){var n=e(t);return tt(t)?n:sr(n,r(t))};var ar=function(t,e){for(var r=-1,n=null==t?0:t.length,o=0,i=[];++r<n;){var s=t[r];e(s,r,t)&&(i[o++]=s)}return i};var ur=function(){return[]},lr=Object.prototype.propertyIsEnumerable,fr=Object.getOwnPropertySymbols,pr=fr?function(t){return null==t?[]:(t=Object(t),ar(fr(t),function(e){return lr.call(t,e)}))}:ur;var hr=function(t){return cr(t,Ct,pr)},dr=1,br=Object.prototype.hasOwnProperty;var vr=function(t,e,r,n,o,i){var s=r&dr,c=hr(t),a=c.length;if(a!=hr(e).length&&!s)return!1;for(var u=a;u--;){var l=c[u];if(!(s?l in e:br.call(e,l)))return!1}var f=i.get(t);if(f&&i.get(e))return f==e;var p=!0;i.set(t,e),i.set(e,t);for(var h=s;++u<a;){var d=t[l=c[u]],b=e[l];if(n)var v=s?n(b,d,l,e,t,i):n(d,b,l,t,e,i);if(!(void 0===v?d===b||o(d,b,r,n,i):v)){p=!1;break}h||(h="constructor"==l)}if(p&&!h){var y=t.constructor,m=e.constructor;y!=m&&"constructor"in t&&"constructor"in e&&!("function"==typeof y&&y instanceof y&&"function"==typeof m&&m instanceof m)&&(p=!1)}return i.delete(t),i.delete(e),p},yr=oe(N,"DataView"),mr=oe(N,"Promise"),_r=oe(N,"Set"),gr=oe(N,"WeakMap"),Er=Yt(yr),Sr=Yt(ie),Rr=Yt(mr),Ar=Yt(_r),Tr=Yt(gr),Or=z;(yr&&"[object DataView]"!=Or(new yr(new ArrayBuffer(1)))||ie&&"[object Map]"!=Or(new ie)||mr&&"[object Promise]"!=Or(mr.resolve())||_r&&"[object Set]"!=Or(new _r)||gr&&"[object WeakMap]"!=Or(new gr))&&(Or=function(t){var e=z(t),r="[object Object]"==e?t.constructor:void 0,n=r?Yt(r):"";if(n)switch(n){case Er:return"[object DataView]";case Sr:return"[object Map]";case Rr:return"[object Promise]";case Ar:return"[object Set]";case Tr:return"[object WeakMap]"}return e});var wr=Or,Cr=1,Ur="[object Arguments]",Ir="[object Array]",Pr="[object Object]",jr=Object.prototype.hasOwnProperty;var Dr=function(t,e,r,n,o,i){var s=tt(t),c=tt(e),a=s?Ir:wr(t),u=c?Ir:wr(e),l=(a=a==Ur?Pr:a)==Pr,f=(u=u==Ur?Pr:u)==Pr,p=a==u;if(p&&rt(t)){if(!rt(e))return!1;s=!0,l=!1}if(p&&!l)return i||(i=new Ie),s||ht(t)?xe(t,e,r,n,o,i):ir(t,e,a,r,n,o,i);if(!(r&Cr)){var h=l&&jr.call(t,"__wrapped__"),d=f&&jr.call(e,"__wrapped__");if(h||d){var b=h?t.value():t,v=d?e.value():e;return i||(i=new Ie),o(b,v,r,n,i)}}return!!p&&(i||(i=new Ie),vr(t,e,r,n,o,i))};var Nr=function t(e,r,n,o,i){return e===r||(null==e||null==r||!W(e)&&!W(r)?e!=e&&r!=r:Dr(e,r,n,o,t,i))},Lr=1,kr=2;var Hr=function(t,e,r,n){var o=r.length,i=o,s=!n;if(null==t)return!i;for(t=Object(t);o--;){var c=r[o];if(s&&c[2]?c[1]!==t[c[0]]:!(c[0]in t))return!1}for(;++o<i;){var a=(c=r[o])[0],u=t[a],l=c[1];if(s&&c[2]){if(void 0===u&&!(a in t))return!1}else{var f=new Ie;if(n)var p=n(u,l,a,t,e,f);if(!(void 0===p?Nr(l,u,Lr|kr,n,f):p))return!1}}return!0};var Fr=function(t){return t==t&&!Et(t)};var Mr=function(t){for(var e=Ct(t),r=e.length;r--;){var n=e[r],o=t[n];e[r]=[n,o,Fr(o)]}return e};var xr=function(t,e){return function(r){return null!=r&&r[t]===e&&(void 0!==e||t in Object(r))}};var Jr=function(t){var e=Mr(t);return 1==e.length&&e[0][2]?xr(e[0][0],e[0][1]):function(r){return r===t||Hr(r,t,e)}},$r="[object Symbol]";var Kr=function(t){return"symbol"==typeof t||W(t)&&z(t)==$r},Gr=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Br=/^\w*$/;var zr=function(t,e){if(tt(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!Kr(t))||Br.test(t)||!Gr.test(t)||null!=e&&t in Object(e)},Wr="Expected a function";function Vr(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError(Wr);var r=function(){var n=arguments,o=e?e.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var s=t.apply(this,n);return r.cache=i.set(o,s)||i,s};return r.cache=new(Vr.Cache||Oe),r}Vr.Cache=Oe;var Yr=Vr,Xr=500;var qr=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Qr=/\\(\\)?/g,Zr=function(t){var e=Yr(t,function(t){return r.size===Xr&&r.clear(),t}),r=e.cache;return e}(function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(qr,function(t,r,n,o){e.push(n?o.replace(Qr,"$1"):r||t)}),e});var tn=function(t,e){for(var r=-1,n=null==t?0:t.length,o=Array(n);++r<n;)o[r]=e(t[r],r,t);return o},en=1/0,rn=L?L.prototype:void 0,nn=rn?rn.toString:void 0;var on=function t(e){if("string"==typeof e)return e;if(tt(e))return tn(e,t)+"";if(Kr(e))return nn?nn.call(e):"";var r=e+"";return"0"==r&&1/e==-en?"-0":r};var sn=function(t){return null==t?"":on(t)};var cn=function(t,e){return tt(t)?t:zr(t,e)?[t]:Zr(sn(t))},an=1/0;var un=function(t){if("string"==typeof t||Kr(t))return t;var e=t+"";return"0"==e&&1/t==-an?"-0":e};var ln=function(t,e){for(var r=0,n=(e=cn(e,t)).length;null!=t&&r<n;)t=t[un(e[r++])];return r&&r==n?t:void 0};var fn=function(t,e,r){var n=null==t?void 0:ln(t,e);return void 0===n?r:n};var pn=function(t,e){return null!=t&&e in Object(t)};var hn=function(t,e,r){for(var n=-1,o=(e=cn(e,t)).length,i=!1;++n<o;){var s=un(e[n]);if(!(i=null!=t&&r(t,s)))break;t=t[s]}return i||++n!=o?i:!!(o=null==t?0:t.length)&&ct(o)&&it(s,o)&&(tt(t)||Z(t))};var dn=function(t,e){return null!=t&&hn(t,e,pn)},bn=1,vn=2;var yn=function(t,e){return zr(t)&&Fr(e)?xr(un(t),e):function(r){var n=fn(r,t);return void 0===n&&n===e?dn(r,t):Nr(e,n,bn|vn)}};var mn=function(t){return t};var _n=function(t){return function(e){return null==e?void 0:e[t]}};var gn=function(t){return function(e){return ln(e,t)}};var En=function(t){return zr(t)?_n(un(t)):gn(t)};var Sn=function(t){return"function"==typeof t?t:null==t?mn:"object"==typeof t?tt(t)?yn(t[0],t[1]):Jr(t):En(t)};var Rn=function(t,e){return w(t,Sn(e,3),Ut)};function An(t){let r={};for(let n in t)if(t.hasOwnProperty(n)&&R(n)&&t[n]){r=e({},r,{[n]:JSON.parse(t[n])})}return r}class Tn{static createState(t){return{recordActive:!1,notifications:{},notificationsCounter:0,autoSaveEnabled:!1,isPriceUpdateEnabled:!1,selection:null,isSimilarElementHighlighted:!1,originalBackgroundColor:null,isCurrentPageTracked:!1,faviconURL:null,_faviconURLMap:{},currentURL:null,canonicalURL:null,browserURL:null,domain:null,_sortItemsBy:t,_undoRemovedItems:[],_undoRemovedItemsResetTask:null}}static toggleRecord(t){return e({},t,{recordActive:!t.recordActive})}static disableRecord(t){return e({},t,{recordActive:!1})}static updateCurrentDomain(t,r){return e({},t,{domain:r})}static updateCurrentURL(t,r){return e({},t,{currentURL:r})}static updateCanonicalURL(t,r){return e({},t,{canonicalURL:r})}static updateBrowserURL(t,r){return e({},t,{browserURL:r})}static enableCurrentPageTracked(t){return e({},t,{isCurrentPageTracked:!0})}static disableCurrentPageTracked(t){return e({},t,{isCurrentPageTracked:!1})}static updateFaviconURL(t,r){return e({},t,{faviconURL:r})}static updateFaviconURLMapItem(t,r,n){return e({},t,{_faviconURLMap:e({},t._faviconURLMap,{[r]:n})})}static enableAutoSave(t,r){return e({},t,{autoSaveEnabled:!0,selection:r=r||t.selection})}static disableAutoSave(t){return e({},t,{autoSaveEnabled:!1})}static enablePriceUpdate(t,r){return e({},t,{isPriceUpdateEnabled:!0,selection:r})}static disablePriceUpdate(t){return e({},t,{isPriceUpdateEnabled:!1})}static setSelectionInfo(t,r,n,o,i){return e({},t,{selection:r,price:n,faviconURL:o,faviconAlt:i})}static setSimilarElementHighlight(t,r,n){return e({},t,{isSimilarElementHighlighted:r,originalBackgroundColor:n})}static incrementNotificationsCounter(t){return e({},t,{notificationsCounter:t.notificationsCounter+1})}static deleteNotificationsItem(t,r){const n=e({},t);return delete n.notifications[r],n}static updateNotificationsItem(t,r,n){return e({},t,{notifications:e({},t.notifications,{[r]:n})})}static updateSortItemsBy(t,r){return e({},t,{_sortItemsBy:r})}static addUndoRemovedItem(t,r,{timestamp:n},o){const i={url:r,timestamp:n},s=[...t._undoRemovedItems];return s.unshift(i),e({},t,{_undoRemovedItems:s.slice(0,o)})}static getUndoRemovedItemsHead(t){return t._undoRemovedItems[0]}static removeUndoRemovedItem(t){const r=[...t._undoRemovedItems];return r.shift(),e({},t,{_undoRemovedItems:r})}static resetUndoRemovedItems(t){return e({},t,{_undoRemovedItems:[]})}static setUndoRemovedItemsResetTask(t,r){return e({},t,{_undoRemovedItemsResetTask:r})}static toStorageStateFormat(t){return Object.keys(t).reduce((r,n)=>e({},r,{[n]:JSON.stringify(t[n])}),{})}}function On(){chrome.storage.local.get(null,t=>{const e=An(t);chrome.storage.sync.get(null,t=>{const r=An(t),n=JSON.parse(JSON.stringify(e));for(let t in r)if(r.hasOwnProperty(t)&&R(t)){const e=r[t];if(n[t]){for(let r in e)if(e.hasOwnProperty(r)){const o=e[r];n[t][r]?o.lastUpdateTimestamp>n[t][r].lastUpdateTimestamp&&(n[t][r]=JSON.parse(JSON.stringify(o))):n[t][r]=Object.assign({},o)}}else n[t]=JSON.parse(JSON.stringify(e))}chrome.storage.local.set(Tn.toStorageStateFormat(n)),chrome.storage.sync.set(Tn.toStorageStateFormat(n))})})}var wn=function(t,e,r,n){for(var o=t.length,i=r+(n?1:-1);n?i--:++i<o;)if(e(t[i],i,t))return i;return-1};var Cn=function(t){return t!=t};var Un=function(t,e,r){for(var n=r-1,o=t.length;++n<o;)if(t[n]===e)return n;return-1};var In=function(t,e,r){return e==e?Un(t,e,r):wn(t,Cn,r)};var Pn=function(t,e){return!(null==t||!t.length)&&In(t,e,0)>-1};var jn=function(t,e,r){for(var n=-1,o=null==t?0:t.length;++n<o;)if(r(e,t[n]))return!0;return!1};var Dn=function(){},Nn=_r&&1/Ke(new _r([,-0]))[1]==1/0?function(t){return new _r(t)}:Dn,Ln=200;var kn=function(t,e,r){var n=-1,o=Pn,i=t.length,s=!0,c=[],a=c;if(r)s=!1,o=jn;else if(i>=Ln){var u=e?null:Nn(t);if(u)return Ke(u);s=!1,o=He,a=new Le}else a=e?[]:c;t:for(;++n<i;){var l=t[n],f=e?e(l):l;if(l=r||0!==l?l:0,s&&f==f){for(var p=a.length;p--;)if(a[p]===f)continue t;e&&a.push(f),c.push(l)}else o(a,f,r)||(a!==c&&a.push(f),c.push(l))}return c};var Hn=function(t){return t&&t.length?kn(t):[]};class Fn{constructor(t,e,r,n,o,i,s=null,c=e,a,u){this.selection=t,this.price=e,this.currentPrice=c,this.startingPrice=e,this.previousPrice=r||null,this.faviconURL=n,this.faviconAlt=o,this.timestamp=a||(new Date).getTime(),this.lastUpdateTimestamp=u||(new Date).getTime(),this.statuses=i,this.diffPercentage=s}updateCurrentPrice(t){return this.previousPrice=this.currentPrice,this.currentPrice=t,this.updateDiffPercentage()}updateDiffPercentage(){const t=100*Math.abs(this.currentPrice-this.price)/this.price,e=parseFloat(t.toFixed(2));let r=null;e&&((r=this.currentPrice>this.price?+e:-e)>0&&r<1?r=Math.ceil(r):r>-1&&r<0&&(r=Math.floor(r))),this.diffPercentage=r}updateTrackStatus(t,e,r,n=!1){e||(e=[]),r||(r=[]),this.statuses=Hn([...this.removeStatuses(r),...e]),this.lastUpdateTimestamp=(new Date).getTime(),n&&(this.startingPrice=this.price),t&&(this.price=t)}removeStatuses(t=[]){return t.length>0&&this.statuses.length>0?this.statuses.filter(e=>!t.includes(e)):this.statuses}isWatched(){return this.statuses.includes(p.WATCHED)}isNotFound(){return this.statuses.includes(p.NOT_FOUND)}hasAcknowledgeDecrease(){return this.statuses.includes(p.ACK_DECREASE)}hasAcknowledgeIncrease(){return this.statuses.includes(p.ACK_INCREASE)}}class Mn{static createItem(t,e,r,n,o,i,s){return new Fn(t,e,r,n,o,i,s)}static createItemFromObject({selection:t,price:e,previousPrice:r,faviconURL:n,faviconAlt:o,statuses:i,diffPercentage:s,currentPrice:c,timestamp:a,lastUpdateTimestamp:u}){return new Fn(t,e,r,n,o,i,s,c,a,u)}}var xn={TIME:function({timestamp:t},{timestamp:e}){return t-e},CURRENT_PRICE:function({currentPrice:t},{currentPrice:e}){return t-e}};function Jn(t,e){const r=new XMLHttpRequest;r.onload=function(){const t=function(t){const e=document.createElement("template");return e.innerHTML=t.trim(),e.content}(this.response);e(t)},r.open("GET",t),r.send()}var $n=function(t,e){return($n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function Kn(t,e){function r(){this.constructor=t}$n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}function Gn(t){return"function"==typeof t}var Bn=!1,zn={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){t&&(new Error).stack;Bn=t},get useDeprecatedSynchronousErrorHandling(){return Bn}};function Wn(t){setTimeout(function(){throw t})}var Vn={closed:!0,next:function(t){},error:function(t){if(zn.useDeprecatedSynchronousErrorHandling)throw t;Wn(t)},complete:function(){}},Yn=Array.isArray||function(t){return t&&"number"==typeof t.length};function Xn(t){return null!=t&&"object"==typeof t}var qn,Qn={e:{}};function Zn(){try{return qn.apply(this,arguments)}catch(t){return Qn.e=t,Qn}}function to(t){return qn=t,Zn}function eo(t){return Error.call(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map(function(t,e){return e+1+") "+t.toString()}).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t,this}eo.prototype=Object.create(Error.prototype);var ro=eo,no=function(){function t(t){this.closed=!1,this._parent=null,this._parents=null,this._subscriptions=null,t&&(this._unsubscribe=t)}var e;return t.prototype.unsubscribe=function(){var t,e=!1;if(!this.closed){var r=this._parent,n=this._parents,o=this._unsubscribe,i=this._subscriptions;this.closed=!0,this._parent=null,this._parents=null,this._subscriptions=null;for(var s=-1,c=n?n.length:0;r;)r.remove(this),r=++s<c&&n[s]||null;if(Gn(o))to(o).call(this)===Qn&&(e=!0,t=t||(Qn.e instanceof ro?oo(Qn.e.errors):[Qn.e]));if(Yn(i))for(s=-1,c=i.length;++s<c;){var a=i[s];if(Xn(a))if(to(a.unsubscribe).call(a)===Qn){e=!0,t=t||[];var u=Qn.e;u instanceof ro?t=t.concat(oo(u.errors)):t.push(u)}}if(e)throw new ro(t)}},t.prototype.add=function(e){if(!e||e===t.EMPTY)return t.EMPTY;if(e===this)return this;var r=e;switch(typeof e){case"function":r=new t(e);case"object":if(r.closed||"function"!=typeof r.unsubscribe)return r;if(this.closed)return r.unsubscribe(),r;if("function"!=typeof r._addParent){var n=r;(r=new t)._subscriptions=[n]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}return(this._subscriptions||(this._subscriptions=[])).push(r),r._addParent(this),r},t.prototype.remove=function(t){var e=this._subscriptions;if(e){var r=e.indexOf(t);-1!==r&&e.splice(r,1)}},t.prototype._addParent=function(t){var e=this._parent,r=this._parents;e&&e!==t?r?-1===r.indexOf(t)&&r.push(t):this._parents=[t]:this._parent=t},t.EMPTY=((e=new t).closed=!0,e),t}();function oo(t){return t.reduce(function(t,e){return t.concat(e instanceof ro?e.errors:e)},[])}var io="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random(),so=function(t){function e(r,n,o){var i=t.call(this)||this;switch(i.syncErrorValue=null,i.syncErrorThrown=!1,i.syncErrorThrowable=!1,i.isStopped=!1,i._parentSubscription=null,arguments.length){case 0:i.destination=Vn;break;case 1:if(!r){i.destination=Vn;break}if("object"==typeof r){r instanceof e?(i.syncErrorThrowable=r.syncErrorThrowable,i.destination=r,r.add(i)):(i.syncErrorThrowable=!0,i.destination=new co(i,r));break}default:i.syncErrorThrowable=!0,i.destination=new co(i,r,n,o)}return i}return Kn(e,t),e.prototype[io]=function(){return this},e.create=function(t,r,n){var o=new e(t,r,n);return o.syncErrorThrowable=!1,o},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this))},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},e.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},e.prototype._unsubscribeAndRecycle=function(){var t=this._parent,e=this._parents;return this._parent=null,this._parents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parent=t,this._parents=e,this._parentSubscription=null,this},e}(no),co=function(t){function e(e,r,n,o){var i,s=t.call(this)||this;s._parentSubscriber=e;var c=s;return Gn(r)?i=r:r&&(i=r.next,n=r.error,o=r.complete,r!==Vn&&(Gn((c=Object.create(r)).unsubscribe)&&s.add(c.unsubscribe.bind(c)),c.unsubscribe=s.unsubscribe.bind(s))),s._context=c,s._next=i,s._error=n,s._complete=o,s}return Kn(e,t),e.prototype.next=function(t){if(!this.isStopped&&this._next){var e=this._parentSubscriber;zn.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}},e.prototype.error=function(t){if(!this.isStopped){var e=this._parentSubscriber,r=zn.useDeprecatedSynchronousErrorHandling;if(this._error)r&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)r?(e.syncErrorValue=t,e.syncErrorThrown=!0):Wn(t),this.unsubscribe();else{if(this.unsubscribe(),r)throw t;Wn(t)}}},e.prototype.complete=function(){var t=this;if(!this.isStopped){var e=this._parentSubscriber;if(this._complete){var r=function(){return t._complete.call(t._context)};zn.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,r),this.unsubscribe()):(this.__tryOrUnsub(r),this.unsubscribe())}else this.unsubscribe()}},e.prototype.__tryOrUnsub=function(t,e){try{t.call(this._context,e)}catch(t){if(this.unsubscribe(),zn.useDeprecatedSynchronousErrorHandling)throw t;Wn(t)}},e.prototype.__tryOrSetError=function(t,e,r){if(!zn.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,r)}catch(e){return zn.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=e,t.syncErrorThrown=!0,!0):(Wn(e),!0)}return!1},e.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()},e}(so);var ao="function"==typeof Symbol&&Symbol.observable||"@@observable";function uo(){}var lo=function(){function t(t){this._isScalar=!1,t&&(this._subscribe=t)}return t.prototype.lift=function(e){var r=new t;return r.source=this,r.operator=e,r},t.prototype.subscribe=function(t,e,r){var n=this.operator,o=function(t,e,r){if(t){if(t instanceof so)return t;if(t[io])return t[io]()}return t||e||r?new so(t,e,r):new so(Vn)}(t,e,r);if(n?n.call(o,this.source):o.add(this.source||zn.useDeprecatedSynchronousErrorHandling&&!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),zn.useDeprecatedSynchronousErrorHandling&&o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){zn.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),!function(t){for(;t;){var e=t,r=e.closed,n=e.destination,o=e.isStopped;if(r||o)return!1;t=n&&n instanceof so?n:null}return!0}(t)?console.warn(e):t.error(e)}},t.prototype.forEach=function(t,e){var r=this;return new(e=fo(e))(function(e,n){var o;o=r.subscribe(function(e){try{t(e)}catch(t){n(t),o&&o.unsubscribe()}},n,e)})},t.prototype._subscribe=function(t){var e=this.source;return e&&e.subscribe(t)},t.prototype[ao]=function(){return this},t.prototype.pipe=function(){for(var t,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return 0===e.length?this:((t=e)?1===t.length?t[0]:function(e){return t.reduce(function(t,e){return e(t)},e)}:uo)(this)},t.prototype.toPromise=function(t){var e=this;return new(t=fo(t))(function(t,r){var n;e.subscribe(function(t){return n=t},function(t){return r(t)},function(){return t(n)})})},t.create=function(e){return new t(e)},t}();function fo(t){if(t||(t=zn.Promise||Promise),!t)throw new Error("no Promise impl found");return t}function po(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}po.prototype=Object.create(Error.prototype);var ho=function(t){function e(e){var r=t.call(this,e)||this;return r.destination=e,r}return Kn(e,t),e}(so);var bo=function(){function t(t){this.connectable=t}return t.prototype.call=function(t,e){var r=this.connectable;r._refCount++;var n=new vo(t,r),o=e.subscribe(n);return n.closed||(n.connection=r.connect()),o},t}(),vo=function(t){function e(e,r){var n=t.call(this,e)||this;return n.connectable=r,n}return Kn(e,t),e.prototype._unsubscribe=function(){var t=this.connectable;if(t){this.connectable=null;var e=t._refCount;if(e<=0)this.connection=null;else if(t._refCount=e-1,e>1)this.connection=null;else{var r=this.connection,n=t._connection;this.connection=null,!n||r&&n!==r||n.unsubscribe()}}else this.connection=null},e}(so),yo=function(t){function e(e,r){var n=t.call(this)||this;return n.source=e,n.subjectFactory=r,n._refCount=0,n._isComplete=!1,n}return Kn(e,t),e.prototype._subscribe=function(t){return this.getSubject().subscribe(t)},e.prototype.getSubject=function(){var t=this._subject;return t&&!t.isStopped||(this._subject=this.subjectFactory()),this._subject},e.prototype.connect=function(){var t=this._connection;return t||(this._isComplete=!1,(t=this._connection=new no).add(this.source.subscribe(new mo(this.getSubject(),this))),t.closed?(this._connection=null,t=no.EMPTY):this._connection=t),t},e.prototype.refCount=function(){return(t=this).lift(new bo(t));var t},e}(lo).prototype,mo=(yo._subscribe,yo._isComplete,yo.getSubject,yo.connect,yo.refCount,function(t){function e(e,r){var n=t.call(this,e)||this;return n.connectable=r,n}return Kn(e,t),e.prototype._error=function(e){this._unsubscribe(),t.prototype._error.call(this,e)},e.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),t.prototype._complete.call(this)},e.prototype._unsubscribe=function(){var t=this.connectable;if(t){this.connectable=null;var e=t._connection;t._refCount=0,t._subject=null,t._connection=null,e&&e.unsubscribe()}},e}(ho)),_o=new lo(function(t){return t.complete()});function go(t){return t?function(t){return new lo(function(e){return t.schedule(function(){return e.complete()})})}(t):_o}function Eo(t){return t&&"function"==typeof t.schedule}var So=function(t){return function(e){for(var r=0,n=t.length;r<n&&!e.closed;r++)e.next(t[r]);e.closed||e.complete()}};function Ro(t,e){return new lo(e?function(r){var n=new no,o=0;return n.add(e.schedule(function(){o!==t.length?(r.next(t[o++]),r.closed||n.add(this.schedule())):r.complete()})),n}:So(t))}function Ao(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}Ao.prototype=Object.create(Error.prototype);var To=Ao;function Oo(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}Oo.prototype=Object.create(Error.prototype);function wo(t,e){return function(r){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return r.lift(new Co(t,e))}}var Co=function(){function t(t,e){this.project=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new Uo(t,this.project,this.thisArg))},t}(),Uo=function(t){function e(e,r,n){var o=t.call(this,e)||this;return o.project=r,o.count=0,o.thisArg=n||o,o}return Kn(e,t),e.prototype._next=function(t){var e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(so),Io=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Kn(e,t),e.prototype.notifyNext=function(t,e,r,n,o){this.destination.next(e)},e.prototype.notifyError=function(t,e){this.destination.error(t)},e.prototype.notifyComplete=function(t){this.destination.complete()},e}(so),Po=function(t){function e(e,r,n){var o=t.call(this)||this;return o.parent=e,o.outerValue=r,o.outerIndex=n,o.index=0,o}return Kn(e,t),e.prototype._next=function(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)},e.prototype._error=function(t){this.parent.notifyError(t,this),this.unsubscribe()},e.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},e}(so),jo=function(t){return function(e){return t.then(function(t){e.closed||(e.next(t),e.complete())},function(t){return e.error(t)}).then(null,Wn),e}};function Do(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}var No=Do(),Lo=function(t){return function(e){for(var r=t[No]();;){var n=r.next();if(n.done){e.complete();break}if(e.next(n.value),e.closed)break}return"function"==typeof r.return&&e.add(function(){r.return&&r.return()}),e}},ko=function(t){return function(e){var r=t[ao]();if("function"!=typeof r.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return r.subscribe(e)}},Ho=function(t){return t&&"number"==typeof t.length&&"function"!=typeof t};function Fo(t){return t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}var Mo=function(t){if(t instanceof lo)return function(e){return t._isScalar?(e.next(t.value),void e.complete()):t.subscribe(e)};if(t&&"function"==typeof t[ao])return ko(t);if(Ho(t))return So(t);if(Fo(t))return jo(t);if(t&&"function"==typeof t[No])return Lo(t);var e=Xn(t)?"an invalid object":"'"+t+"'";throw new TypeError("You provided "+e+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")};function xo(t,e,r,n,o){if(void 0===o&&(o=new Po(t,r,n)),!o.closed)return Mo(e)(o)}var Jo={};var $o=function(){function t(t){this.resultSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new Ko(t,this.resultSelector))},t}(),Ko=function(t){function e(e,r){var n=t.call(this,e)||this;return n.resultSelector=r,n.active=0,n.values=[],n.observables=[],n}return Kn(e,t),e.prototype._next=function(t){this.values.push(Jo),this.observables.push(t)},e.prototype._complete=function(){var t=this.observables,e=t.length;if(0===e)this.destination.complete();else{this.active=e,this.toRespond=e;for(var r=0;r<e;r++){var n=t[r];this.add(xo(this,n,n,r))}}},e.prototype.notifyComplete=function(t){0==(this.active-=1)&&this.destination.complete()},e.prototype.notifyNext=function(t,e,r,n,o){var i=this.values,s=i[r],c=this.toRespond?s===Jo?--this.toRespond:this.toRespond:0;i[r]=e,0===c&&(this.resultSelector?this._tryResultSelector(i):this.destination.next(i.slice()))},e.prototype._tryResultSelector=function(t){var e;try{e=this.resultSelector.apply(this,t)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(Io);function Go(t,e){if(!e)return t instanceof lo?t:new lo(Mo(t));if(null!=t){if(function(t){return t&&"function"==typeof t[ao]}(t))return function(t,e){return new lo(e?function(r){var n=new no;return n.add(e.schedule(function(){var o=t[ao]();n.add(o.subscribe({next:function(t){n.add(e.schedule(function(){return r.next(t)}))},error:function(t){n.add(e.schedule(function(){return r.error(t)}))},complete:function(){n.add(e.schedule(function(){return r.complete()}))}}))})),n}:ko(t))}(t,e);if(Fo(t))return function(t,e){return new lo(e?function(r){var n=new no;return n.add(e.schedule(function(){return t.then(function(t){n.add(e.schedule(function(){r.next(t),n.add(e.schedule(function(){return r.complete()}))}))},function(t){n.add(e.schedule(function(){return r.error(t)}))})})),n}:jo(t))}(t,e);if(Ho(t))return Ro(t,e);if(function(t){return t&&"function"==typeof t[No]}(t)||"string"==typeof t)return function(t,e){if(!t)throw new Error("Iterable cannot be null");return new lo(e?function(r){var n,o=new no;return o.add(function(){n&&"function"==typeof n.return&&n.return()}),o.add(e.schedule(function(){n=t[No](),o.add(e.schedule(function(){if(!r.closed){var t,e;try{var o=n.next();t=o.value,e=o.done}catch(t){return void r.error(t)}e?r.complete():(r.next(t),this.schedule())}}))})),o}:Lo(t))}(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}function Bo(t,e,r){return r?Bo(t,e).pipe(wo(function(t){return Yn(t)?r.apply(void 0,t):r(t)})):new lo(function(r){var n,o=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return r.next(1===t.length?t[0]:t)};try{n=t(o)}catch(t){return void r.error(t)}if(Gn(e))return function(){return e(o,n)}})}function zo(t,e){return function(r){return r.lift(new Wo(t,e))}}var Wo=function(){function t(t,e){this.predicate=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new Vo(t,this.predicate,this.thisArg))},t}(),Vo=function(t){function e(e,r,n){var o=t.call(this,e)||this;return o.predicate=r,o.thisArg=n,o.count=0,o}return Kn(e,t),e.prototype._next=function(t){var e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}e&&this.destination.next(t)},e}(so);var Yo=function(){function t(t){if(this.total=t,this.total<0)throw new To}return t.prototype.call=function(t,e){return e.subscribe(new Xo(t,this.total))},t}(),Xo=function(t){function e(e,r){var n=t.call(this,e)||this;return n.total=r,n.count=0,n}return Kn(e,t),e.prototype._next=function(t){var e=this.total,r=++this.count;r<=e&&(this.destination.next(t),r===e&&(this.destination.complete(),this.unsubscribe()))},e}(so);function qo(t,e){return"function"==typeof e?function(r){return r.pipe(qo(function(r,n){return Go(t(r,n)).pipe(wo(function(t,o){return e(r,t,n,o)}))}))}:function(e){return e.lift(new Qo(t))}}var Qo=function(){function t(t){this.project=t}return t.prototype.call=function(t,e){return e.subscribe(new Zo(t,this.project))},t}(),Zo=function(t){function e(e,r){var n=t.call(this,e)||this;return n.project=r,n.index=0,n}return Kn(e,t),e.prototype._next=function(t){var e,r=this.index++;try{e=this.project(t,r)}catch(t){return void this.destination.error(t)}this._innerSub(e,t,r)},e.prototype._innerSub=function(t,e,r){var n=this.innerSubscription;n&&n.unsubscribe();var o=new Po(this,void 0,void 0);this.destination.add(o),this.innerSubscription=xo(this,t,e,r,o)},e.prototype._complete=function(){var e=this.innerSubscription;e&&!e.closed||t.prototype._complete.call(this),this.unsubscribe()},e.prototype._unsubscribe=function(){this.innerSubscription=null},e.prototype.notifyComplete=function(e){this.destination.remove(e),this.innerSubscription=null,this.isStopped&&t.prototype._complete.call(this)},e.prototype.notifyNext=function(t,e,r,n,o){this.destination.next(e)},e}(Io);function ti(t){chrome.runtime.onInstalled.addListener(t)}function ei(){return Bo(ti).pipe((t=1,function(e){return 0===t?go():e.lift(new Yo(t))}));var t}function ri(t){chrome.tabs.onUpdated.addListener(t)}function ni(t){chrome.tabs.query({active:!0,currentWindow:!0},t)}function oi(){return Bo(ni)}function ii(t){chrome.tabs.onActivated.addListener(t)}function si(){return Bo(ii).pipe(qo(()=>oi()),wo(([{id:t,url:e}])=>({id:t,url:e})))}function ci(t){chrome.webNavigation.onCompleted.addListener(t)}function ai(t){chrome.webNavigation.onHistoryStateUpdated.addListener(t)}function ui(){const t=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=null,n=null;return Eo(t[t.length-1])&&(n=t.pop()),"function"==typeof t[t.length-1]&&(r=t.pop()),1===t.length&&Yn(t[0])&&(t=t[0]),Ro(t,n).lift(new $o(r))}(Bo(ci).pipe(wo(({frameId:t})=>t)).pipe(zo(t=>0===t)),Bo(ai)),e=oi().pipe(zo(t=>t.length>0));return t.pipe(qo(()=>e),wo(([{id:t,url:e}])=>({id:t,url:e})),zo(({url:t})=>void 0!==t))}let li=Tn.createState(r);function fi(t,e,r,n,o,i,s,c){chrome.tabs.sendMessage(t,{type:"CONFIRMATION_DISPLAY.CREATE",payload:{elementId:"price-tag--url-confirmation"}},({status:r})=>{if(1===r){const r=function(t,e,r){return{title:"This website recommends to follow this item through a different URL",message:`<u>${r}</u> says that a more accurate URL for this item would be:<br>`+`<i><a href="${t}" target="_blank"  rel="noopener noreferrer">${t}</a></i><br>`+"If this is correct, we recommend you to follow it.<br><br><b>However</b> you can still opt to choose following the current browser URL:<br>"+`<i><a href="${e}" target="_blank" rel="noopener noreferrer">${e}</a></i><br><br>`+"Since your choice will affect the way items are tracked in this site futurely,<br>please help us helping you by choosing carefully one of the following options:",buttons:["Use recommended URL. Remember this option for this site","Use recommended URL but just this time","It's not correct, use the current browser URL. Remember this option","Don't use recommended URL. Use the current browser URL instead but just this time"]}}(li.canonicalURL,li.browserURL,e);chrome.tabs.sendMessage(t,{type:"CONFIRMATION_DISPLAY.LOAD",payload:r},({status:r,index:n})=>{switch(chrome.tabs.sendMessage(t,{type:"CONFIRMATION_DISPLAY.REMOVE",payload:{elementId:"price-tag--url-confirmation"}}),r){case 1:switch(n){case 0:chrome.storage.local.get([e],t=>{const r=t&&t[e]&&JSON.parse(t[e])||{};r._canUseCanonical=!0,chrome.storage.local.set({[e]:JSON.stringify(r)}),li=Tn.updateCurrentURL(li,li.canonicalURL),c(!0,!0)});break;case 1:li=Tn.updateCurrentURL(li,li.canonicalURL),c(!0,!0);break;case 2:chrome.storage.local.get([e],t=>{const r=t&&t[e]&&JSON.parse(t[e])||{};r._canUseCanonical=!1,chrome.storage.local.set({[e]:JSON.stringify(r)}),li=Tn.updateCurrentURL(li,li.browserURL),c(!0,!1)});break;case 3:li=Tn.updateCurrentURL(li,li.browserURL),c(!0,!1);break;default:c(!1)}break;case 2:default:c(!1)}})}})}function pi(){li=Tn.disableRecord(li)}function hi(t,{status:e,selection:r,price:n,faviconURL:o,faviconAlt:i}={}){e>=0?(li=Tn.updateFaviconURL(li,li.faviconURL||o),li=Tn.setSelectionInfo(li,r,n,li.faviconURL,i),t(!0)):t(!1)}function di({status:t,isHighlighted:e,originalBackgroundColor:r=null}){t>=0&&(li=Tn.setSimilarElementHighlight(li,e,r))}function bi(t,e,r,n,o,i,s,c){chrome.storage.local.get([t],a=>{const u=a&&a[t]?JSON.parse(a[t]):{};u[e]=Mn.createItem(r,E(n),null,o,i,s),chrome.storage.local.set({[t]:JSON.stringify(u)},()=>{li=Tn.disableAutoSave(li),c&&c()})})}function vi(t,e,r){chrome.storage.local.get([e],n=>{const o=n&&n[e]&&JSON.parse(n[e])||null,i=!o||void 0===o._canUseCanonical;r(i&&!!t.canonicalURL&&t.canonicalURL!==t.browserURL)})}function yi(){chrome.storage.local.get(null,t=>{for(let e in t)if(t.hasOwnProperty(e)&&R(e)){const r=JSON.parse(t[e]);for(let t in r)if(r.hasOwnProperty(t)&&A(t)){const n=Mn.createItemFromObject(r[t]);if(n.isWatched()){const{price:o,currentPrice:i}=n;Jn(t,s=>{try{let c=null;const{textContent:a}=s.querySelector(r[t].selection);if(a){const s=a.match(m.PRICE);s&&([,c]=s,c=E(c),o?c<i?(n.updateCurrentPrice(c),n.updateTrackStatus(null,[p.DECREASED],[p.INCREASED,p.NOT_FOUND,p.ACK_DECREASE]),r[t]=n,chrome.storage.local.set({[e]:JSON.stringify(r)},()=>{if(c<o&&!n.hasAcknowledgeDecrease()){gi(`TRACK.PRICE_UPDATE-${li.notificationsCounter}`,b,"Lower price!!",`${c} (previous ${o})`,t,t,e,p.DECREASED,{buttons:[{title:`Keep tracking but w/ new price (${c})`},{title:"Stop watching"}]})}})):c>i?(n.updateCurrentPrice(c),n.updateTrackStatus(null,[p.INCREASED],[p.DECREASED,p.NOT_FOUND,p.ACK_INCREASE]),r[t]=n,chrome.storage.local.set({[e]:JSON.stringify(r)},()=>{if(!n.hasAcknowledgeIncrease()){const n=`TRACK.PRICE_UPDATE-${li.notificationsCounter}`,o=r[t].price!==r[t].previousPrice?{buttons:[{title:`Increase interest price to the previous (${r[t].previousPrice})`}]}:{buttons:[]};o.buttons.push({title:"Stop watching"}),gi(n,b,"Price increase",`${c} (previous ${r[t].previousPrice})`,t,t,e,p.INCREASED,o)}})):n.isNotFound()?(n.updateTrackStatus(null,null,[p.NOT_FOUND]),r[t]=n,chrome.storage.local.set({[e]:JSON.stringify(r)})):(n.updateTrackStatus(null,null,[p.NOT_FOUND]),r[t]=n,chrome.storage.local.set({[e]:JSON.stringify(r)},()=>{})):(n.updateTrackStatus(c,[p.FIXED],[p.NOT_FOUND]),r[t]=n,chrome.storage.local.set({[e]:JSON.stringify(r)},()=>{gi(`TRACK.PRICE_FIXED-${li.notificationsCounter}`,y,"Fixed price",`Ermm.. We've just fixed a wrongly set price to ${c}`,t,t,e)})))}n.price&&!c&&(n.isNotFound()||(n.updateTrackStatus(null,[p.NOT_FOUND],[p.DECREASED,p.INCREASED,p.FIXED,p.ACK_DECREASE]),r[t]=n,chrome.storage.local.set({[e]:JSON.stringify(r)},()=>{gi(`TRACK.PRICE_NOT_FOUND-${li.notificationsCounter}`,v,"Price gone",`Price tag no longer found${o?` (previous ${o})`:""}`,t,t,e)})))}catch(i){n.isNotFound()||(console.warn(`Invalid price selection element in\n${t}:\t"${r[t].selection}"`),n.updateTrackStatus(null,[p.NOT_FOUND],[p.DECREASED,p.INCREASED,p.FIXED,p.ACK_DECREASE]),r[t]=n,chrome.storage.local.set({[e]:JSON.stringify(r)},()=>{gi(`TRACK.PRICE_NOT_FOUND-${li.notificationsCounter}`,v,"Price gone",`Price tag no longer found${o?` (previous ${o})`:""}`,t,t,e)}))}})}}}})}function mi(t,r){chrome.storage.local.get(null,n=>{let o=[];Object.keys(n).forEach(t=>{if(R(t)){const r=n[t],i=JSON.parse(r)||null;if(i){let t=[];Object.keys(i).forEach(r=>{if(function(t){return m.HOSTNAME.test(t)}(r)){const n=Mn.createItemFromObject(i[r]);n.isWatched()&&t.push(e({},n,{url:r}))}}),o=[...o,...t]}}});const i=xn[t];o.sort(i),r(o)})}function _i(t,e){chrome.notifications.clear(t,r=>{if(r||e){const{domain:e,url:r,type:n}=li.notifications[t];chrome.storage.local.get([e],t=>{const o=t&&t[e]?JSON.parse(t[e]):null,i=Mn.createItemFromObject(o[r]);switch(n){case p.DECREASED:i.updateTrackStatus(null,[p.ACK_DECREASE]);break;case p.INCREASED:i.updateTrackStatus(null,[p.ACK_INCREASE])}o[r]=i,chrome.storage.local.set({[e]:JSON.stringify(o)})})}li=Tn.deleteNotificationsItem(li,t)})}function gi(t,r,n,o,i="",s,c,a,u={}){const l=e({type:"basic",title:n,message:o,iconUrl:r,contextMessage:i,requireInteraction:!0},u);chrome.notifications.create(t,l,t=>{li=Tn.updateNotificationsItem(li,t,{url:s,domain:c,type:a})}),li=Tn.incrementNotificationsCounter(li)}function Ei(t,e,r){chrome.storage.local.get([e],n=>{const o=n&&n[e]?JSON.parse(n[e]):{},i=o[t]&&Mn.createItemFromObject(o[t]),s=o[r]&&Mn.createItemFromObject(o[r]),c=i&&i.isWatched()||s&&s.isWatched();if(o&&!c){const t=function(t){return Rn(t,(t,e)=>A(e))}(o),e=o[t]&&Mn.createItemFromObject(o[t]);e&&e.selection&&(li=Tn.enableAutoSave(li,e.selection))}else li=Tn.disableAutoSave(li)})}function Si(t,e,r){chrome.storage.local.get([e],n=>{const o=n&&n[e]?JSON.parse(n[e]):{},i=o[t]&&Mn.createItemFromObject(o[t])||o[r]&&Mn.createItemFromObject(o[r]),s=i&&i.price!==i.currentPrice;li=s?Tn.enablePriceUpdate(li,i.selection):Tn.disablePriceUpdate(li)})}function Ri(t,e,r,n){!0===r?(g(),li=Tn.enableCurrentPageTracked(li)):!1===r?(_(),li=Tn.disableCurrentPageTracked(li)):r||chrome.storage.local.get([t],r=>{const o=function(t,e){return t&&t[e]&&JSON.parse(t[e])||null}(r,t);if(o){const t=o[e]||o[n],r=t&&Mn.createItemFromObject(t);r&&r.isWatched()?(g(),li=Tn.enableCurrentPageTracked(li)):(_(),li=Tn.disableCurrentPageTracked(li))}else _(),li=Tn.disableCurrentPageTracked(li)})}function Ai(t,e,r){const n=T(e);for(let o in t)if(t.hasOwnProperty(o)&&A(o)){if(Mn.createItemFromObject(t[o]).isWatched()){if(e===o)return void r(null);if(T(o)===n)return void r(o)}}r(null)}function Ti(t,e,r,n){chrome.storage.local.get([e],o=>{const i=o&&o[e]&&JSON.parse(o[e])||null;i?!0===i._isPathEnoughToTrack?Ai(i,r,t=>{t?n(!1,!1):n(!0)}):!1===i._isPathEnoughToTrack?n(!0):Ai(i,r,o=>{if(o){const s="price-tag--save-confirmation";chrome.tabs.sendMessage(t,{type:"CONFIRMATION_DISPLAY.CREATE",payload:{elementId:s}},({status:c})=>{if(1===c){const c=function(t,e){return{title:"Item with similar URL to existing one",message:"It appears that the item URL you're trying to save:<br>"+`<i><a href="${t}" target="_blank" rel="noopener noreferrer">${t}</a></i><br>`+"is pretty similar to<br>"+`<i><a href="${e}" target="_blank" rel="noopener noreferrer">${e}</a></i><br><br>`+"Since your choice will affect the way items are tracked in this site futurely,<br>please help us helping you by choosing carefully one of the following options:",buttons:["It's not, save it! Remember this option for this site.","Don't save. Ask me again for items of this site!","Indeed the same item. Don't save! Remember this option for this site. (Use just URL path for accessing items)","For now save this item. Ask me again next time!"]}}(r,o);chrome.tabs.sendMessage(t,{type:"CONFIRMATION_DISPLAY.LOAD",payload:c},({status:r,index:o})=>{switch(chrome.tabs.sendMessage(t,{type:"CONFIRMATION_DISPLAY.REMOVE",payload:{elementId:s}}),r){case 1:switch(o){case 0:i._isPathEnoughToTrack=!1,chrome.storage.local.set({[e]:JSON.stringify(i)}),n(!0);break;case 1:n(!1,!0);break;case 2:i._isPathEnoughToTrack=!0,chrome.storage.local.set({[e]:JSON.stringify(i)}),n(!1,!1);break;case 3:n(!0);break;default:n(!1,!0)}break;case 2:default:n(!1,!0)}})}else n(!1,!0)})}else n(!0)}):n(!0)})}function Oi(t,e){const r=e.match(m.CAPTURE.DOMAIN_IN_URL);if(r){const[,t]=r;li=Tn.updateCurrentDomain(li,t),chrome.storage.local.get([t],r=>{const n=r&&r[t]&&JSON.parse(r[t])||null;if(n&&!1===n._canUseCanonical){if(li=Tn.updateCanonicalURL(li,null),li=Tn.updateCurrentURL(li,e),li=Tn.updateBrowserURL(li,e),!0===n._isPathEnoughToTrack){const t=O(e);t&&(li=Tn.updateCurrentURL(li,t),li=Tn.updateBrowserURL(li,t))}Ei(li.currentURL,li.domain,e),Si(li.currentURL,li.domain,e),Ri(li.domain,li.currentURL,null,e)}else li=Tn.updateBrowserURL(li,e),Jn(e,t=>{const r=function(t){const e=t.querySelector('link[rel="canonical"]');return e&&e.getAttribute("href")}(t);if(S(r))li=Tn.updateCurrentURL(li,r),li=Tn.updateCanonicalURL(li,r);else if(li=Tn.updateCanonicalURL(li,null),li=Tn.updateCurrentURL(li,e),n&&!0===n._isPathEnoughToTrack){const t=O(e);t&&(li=Tn.updateCurrentURL(li,t),li=Tn.updateBrowserURL(li,t))}Ei(li.currentURL,li.domain,e),Si(li.currentURL,li.domain,e),Ri(li.domain,li.currentURL,null,e)})})}}function wi(){ei().subscribe(()=>{console.log("Price tag installed.")}),si().subscribe(({id:t,url:e})=>{e.startsWith("http")?(Oi(0,e),li=Tn.updateFaviconURL(li,li._faviconURLMap[t]||null)):_()}),Bo(ri).pipe(wo(([t,{favIconUrl:e},{active:r,url:n}])=>({tabId:t,favIconUrl:e,active:r,url:n}))).subscribe(({tabId:t,favIconUrl:e,active:r,url:n})=>{n.startsWith("http")?r&&e&&(li=Tn.updateFaviconURLMapItem(li,t,e),li=Tn.updateFaviconURL(li,e)):_()}),ui().subscribe(({id:t,url:e})=>{e!==li.browserURL&&Oi(0,e)}),chrome.runtime.onMessage.addListener(({type:t,payload:o={}},i,a)=>{let u;const{id:l,url:f,sortByType:h}=o,{recordActive:d,autoSaveEnabled:b,isPriceUpdateEnabled:v,currentURL:y,domain:m}=li;switch(t){case"POPUP.STATUS":a({status:1,state:{recordActive:d,autoSaveEnabled:b,isPriceUpdateEnabled:v}});break;case"RECORD.ATTEMPT":if((li=Tn.toggleRecord(li)).recordActive){const{url:t}=o;chrome.tabs.sendMessage(l,{type:"RECORD.START",payload:{url:t}},function(t,e){const{status:r,selection:n,price:o,faviconURL:i,faviconAlt:s}=e,{currentURL:c,domain:a}=li;r>0&&(vi(li=Tn.updateFaviconURL(li,li.faviconURL||i),a,e=>{e?fi(t,a,0,0,0,0,0,(e,r)=>{if(e){const e=r?li.canonicalURL:li.browserURL;Ti(t,a,e,t=>{t&&(bi(a,e,n,o,li.faviconURL,s,[p.WATCHED]),Ri(a,e,!0))})}}):Ti(t,a,c,t=>{t&&(bi(a,c,n,o,li.faviconURL,s,[p.WATCHED]),Ri(a,c,!0))})}),li=Tn.disableRecord(li))}.bind(null,l))}else chrome.tabs.sendMessage(l,{type:"RECORD.CANCEL"},pi);a({status:1,state:{recordActive:li.recordActive}});break;case"AUTO_SAVE.STATUS":return chrome.storage.local.get([m],t=>{const e=t&&t[m]&&JSON.parse(t[m])||null;e&&!0===e._isPathEnoughToTrack?Ai(e,y,t=>{t?a({status:-1}):chrome.tabs.sendMessage(l,{type:"AUTO_SAVE.CHECK_STATUS",payload:{url:y,selection:li.selection}},hi.bind(null,a))}):chrome.tabs.sendMessage(l,{type:"AUTO_SAVE.CHECK_STATUS",payload:{url:y,selection:li.selection}},hi.bind(null,a))}),!0;case"AUTO_SAVE.ATTEMPT":if(li.autoSaveEnabled){const{domain:t,currentURL:e,selection:r,price:n,faviconURL:o,faviconAlt:i,originalBackgroundColor:s}=li;return vi(li,t,c=>{c?fi(l,t,0,0,0,0,0,(e,c)=>{if(e){const e=c?li.canonicalURL:li.browserURL;Ti(l,t,e,(c,u)=>{c?bi(t,e,r,n,o,i,[p.WATCHED],()=>{chrome.tabs.sendMessage(l,{type:"PRICE_TAG.HIGHLIGHT.STOP",payload:{selection:r,originalBackgroundColor:s}},di),Ri(t,e,!0),li=Tn.disableAutoSave(li),a(!1)}):u||(li=Tn.disableAutoSave(li))})}}):Ti(l,t,e,c=>{c&&bi(t,e,r,n,o,i,[p.WATCHED],()=>{chrome.tabs.sendMessage(l,{type:"PRICE_TAG.HIGHLIGHT.STOP",payload:{selection:r,originalBackgroundColor:s}},di),Ri(t,e,!0),li=Tn.disableAutoSave(li),a(!1)})})}),!0}a(!1);break;case"AUTO_SAVE.HIGHLIGHT.PRE_START":if(li.autoSaveEnabled){const{selection:t}=li;chrome.tabs.sendMessage(l,{type:"PRICE_TAG.HIGHLIGHT.START",payload:{selection:t}},di)}break;case"AUTO_SAVE.HIGHLIGHT.PRE_STOP":if(li.autoSaveEnabled){const{selection:t,originalBackgroundColor:e}=li;chrome.tabs.sendMessage(l,{type:"PRICE_TAG.HIGHLIGHT.STOP",payload:{selection:t,originalBackgroundColor:e}},di)}break;case"PRICE_UPDATE.STATUS":return chrome.storage.local.get([li.domain],t=>{const e=t&&t[li.domain]?JSON.parse(t[li.domain]):{},r=e[li.currentURL]&&Mn.createItemFromObject(e[li.currentURL])||e[li.browserURL]&&Mn.createItemFromObject(e[li.browserURL]);r?chrome.tabs.sendMessage(l,{type:"PRICE_UPDATE.CHECK_STATUS",payload:{selection:li.selection}},function(t,e,{status:r,selection:n,price:o,faviconURL:i,faviconAlt:s}={}){r>=0&&(li=Tn.updateFaviconURL(li,li.faviconURL||i),li=Tn.setSelectionInfo(li,n,o,li.faviconURL,s),E(o)!==e)?t(!0):t(!1)}.bind(null,a,r.price)):a(!1)}),!0;case"PRICE_UPDATE.ATTEMPT":if(li.isPriceUpdateEnabled){const{domain:t,currentURL:e,selection:r,price:n,originalBackgroundColor:o}=li,i=n&&E(n);chrome.storage.local.get([t],n=>{const s=n&&n[t]?JSON.parse(n[t]):{},c=Mn.createItemFromObject(s[e]);c.updateTrackStatus(i,null,[p.INCREASED,p.ACK_INCREASE,p.DECREASED,p.INCREASED,p.DECREASED,p.ACK_DECREASE,p.DECREASED,p.DECREASED,p.NOT_FOUND]),c.updateDiffPercentage(),s[e]=c,chrome.storage.local.set({[t]:JSON.stringify(s)}),chrome.tabs.sendMessage(l,{type:"PRICE_TAG.HIGHLIGHT.STOP",payload:{selection:r,originalBackgroundColor:o}},di),li=Tn.disablePriceUpdate(li),a(!1)})}return!0;case"PRICE_UPDATE.HIGHLIGHT.PRE_START":if(li.isPriceUpdateEnabled){const{selection:t}=li;chrome.tabs.sendMessage(l,{type:"PRICE_TAG.HIGHLIGHT.START",payload:{selection:t}},di)}break;case"PRICE_UPDATE.HIGHLIGHT.PRE_STOP":if(li.isPriceUpdateEnabled){const{selection:t,originalBackgroundColor:e}=li;chrome.tabs.sendMessage(l,{type:"PRICE_TAG.HIGHLIGHT.STOP",payload:{selection:t,originalBackgroundColor:e}},di)}break;case"TRACKED_ITEMS.OPEN":u=(li=Tn.updateSortItemsBy(li,r))._undoRemovedItems.length>0,a({isUndoStatusActive:u});break;case"TRACKED_ITEMS.GET":return mi(li._sortItemsBy,a),!0;case"TRACKED_ITEMS.UNFOLLOW":return function(t,r,n){let o=!1;chrome.storage.local.get(null,i=>{Object.keys(i).forEach(a=>{if(R(a)){const u=i[a],l=JSON.parse(u)||null,f=l[t]&&Mn.createItemFromObject(l[t]);if(f){o=!0,li._undoRemovedItemsResetTask&&(clearTimeout(li._undoRemovedItemsResetTask),li=Tn.setUndoRemovedItemsResetTask(li,null));const i=e({},f);li=Tn.addUndoRemovedItem(li,t,i,s),chrome.runtime.sendMessage({type:"TRACKED_ITEMS.UNDO_STATUS",payload:{isUndoStatusActive:!0}});const u=setTimeout(()=>{li=Tn.resetUndoRemovedItems(li),chrome.runtime.sendMessage({type:"TRACKED_ITEMS.UNDO_STATUS",payload:{isUndoStatusActive:!1}})},c);li=Tn.setUndoRemovedItemsResetTask(li,u),f.updateTrackStatus(null,null,[p.WATCHED]),l[t]=f,chrome.storage.local.set({[a]:JSON.stringify(l)},()=>{r===t&&(Ei(t,a),Si(t,a),Ri(a,t,!1)),n(!0)})}}}),o||n(!1)})}(f,li.currentURL,a),!0;case"TRACKED_ITEMS.CHANGE_SORT":li=Tn.updateSortItemsBy(li,n[h]);break;case"TRACKED_ITEMS.UNDO_ATTEMPT":if(li._undoRemovedItems.length>0){return function(t,e,r){let n=!1;chrome.storage.local.get(null,o=>{Object.keys(o).forEach(i=>{if(R(i)){const s=o[i],c=JSON.parse(s)||null,a=c[t]&&Mn.createItemFromObject(c[t]);a&&(n=!0,a.updateTrackStatus(null,[p.WATCHED],null),c[t]=a,chrome.storage.local.set({[i]:JSON.stringify(c)},()=>{e===t&&(Ei(t,i),Si(t,i),Ri(i,t,!0)),r(!0)}))}}),n||r(!0)})}(Tn.getUndoRemovedItemsHead(li).url,li.currentURL,t=>{t&&(0===(li=Tn.removeUndoRemovedItem(li))._undoRemovedItems.length?a({isUndoStatusActive:!1}):a({isUndoStatusActive:!0}))}),!0}a({isUndoStatusActive:!1})}}),chrome.notifications.onClicked.addListener(t=>{chrome.tabs.create({url:li.notifications[t].url}),_i(t)}),chrome.notifications.onButtonClicked.addListener((t,e)=>{const{domain:r,url:n,type:o}=li.notifications[t];switch(e){case 0:switch(o){case p.DECREASED:chrome.storage.local.get([r],t=>{const e=t&&t[r]?JSON.parse(t[r]):{};if(e[n]){const t=Mn.createItemFromObject(e[n]),o=t.price;t.updateTrackStatus(o,null,[p.DECREASED,p.ACK_DECREASE],!0),e[n]=t,chrome.storage.local.set({[r]:JSON.stringify(e)})}});break;case p.INCREASED:chrome.storage.local.get([r],t=>{const e=t&&t[r]?JSON.parse(t[r]):{};if(e[n]){const t=Mn.createItemFromObject(e[n]);t.updateTrackStatus(t.previousPrice,null,[p.INCREASED,p.ACK_INCREASE],!0),e[n]=t,chrome.storage.local.set({[r]:JSON.stringify(e)})}})}break;case 1:switch(o){case p.INCREASED:chrome.storage.local.get([r],t=>{const e=t&&t[r]?JSON.parse(t[r]):{},o=e[n]&&Mn.createItemFromObject(e[n]);o&&(o.updateTrackStatus(null,null,p.ALL_STATUSES),e[n]=o,chrome.storage.local.set({[r]:JSON.stringify(e)}))})}}}),chrome.notifications.onClosed.addListener(_i)}On(),setInterval(On,i),yi(),setInterval(yi,o),wi()}();
